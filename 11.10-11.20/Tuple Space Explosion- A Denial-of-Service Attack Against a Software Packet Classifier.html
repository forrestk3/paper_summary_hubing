<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>Tuple Space Explosion: A Denial-of-Service Attack Against a Software Packet Classifier</title>
</head>
<body>
<div style="visibility: hidden; overflow: hidden; position: absolute; top: 0px; height: 1px; width: auto; padding: 0px; border: 0px; margin: 0px; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal;"><div id="MathJax_SVG_Hidden"></div><svg><defs id="MathJax_SVG_glyphs"><path id="MJCAL-4D" stroke-width="1" d="M28 9Q28 37 43 63T73 90Q77 90 83 84T103 70T141 57H146Q162 57 178 79T222 167Q266 279 295 371T334 513T349 598T358 651T371 677Q397 705 432 705Q442 705 445 699T452 666Q453 661 453 659Q475 538 509 405T568 207L574 192Q581 178 587 164T594 150Q596 150 635 189T693 248Q765 324 863 438T1024 626T1089 701Q1093 705 1100 705Q1111 705 1111 682Q1111 675 1108 660T1099 611T1086 540Q1041 277 1041 144Q1041 98 1044 75T1050 48T1059 42Q1064 41 1075 46Q1102 61 1121 61Q1137 61 1137 50Q1137 28 1087 0T1000 -29Q983 -29 972 -23T955 -9T945 16T942 45T941 83V96Q941 158 952 256T974 422L985 489Q984 489 939 436T821 300T698 164Q665 128 620 85T568 37Q564 34 558 34Q550 34 546 37T535 54Q512 91 496 127T450 259T389 498L384 518Q349 367 294 223T198 15Q155 -50 117 -50Q87 -50 61 -35T30 -6Q28 2 28 9Z"></path><path id="MJMATHI-6D" stroke-width="1" d="M21 287Q22 293 24 303T36 341T56 388T88 425T132 442T175 435T205 417T221 395T229 376L231 369Q231 367 232 367L243 378Q303 442 384 442Q401 442 415 440T441 433T460 423T475 411T485 398T493 385T497 373T500 364T502 357L510 367Q573 442 659 442Q713 442 746 415T780 336Q780 285 742 178T704 50Q705 36 709 31T724 26Q752 26 776 56T815 138Q818 149 821 151T837 153Q857 153 857 145Q857 144 853 130Q845 101 831 73T785 17T716 -10Q669 -10 648 17T627 73Q627 92 663 193T700 345Q700 404 656 404H651Q565 404 506 303L499 291L466 157Q433 26 428 16Q415 -11 385 -11Q372 -11 364 -4T353 8T350 18Q350 29 384 161L420 307Q423 322 423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 181Q151 335 151 342Q154 357 154 369Q154 405 129 405Q107 405 92 377T69 316T57 280Q55 278 41 278H27Q21 284 21 287Z"></path><path id="MJMAIN-2208" stroke-width="1" d="M84 250Q84 372 166 450T360 539Q361 539 377 539T419 540T469 540H568Q583 532 583 520Q583 511 570 501L466 500Q355 499 329 494Q280 482 242 458T183 409T147 354T129 306T124 272V270H568Q583 262 583 250T568 230H124V228Q124 207 134 177T167 112T231 48T328 7Q355 1 466 0H570Q583 -10 583 -20Q583 -32 568 -40H471Q464 -40 446 -40T417 -41Q262 -41 172 45Q84 127 84 250Z"></path><path id="MJMATHI-48" stroke-width="1" d="M228 637Q194 637 192 641Q191 643 191 649Q191 673 202 682Q204 683 219 683Q260 681 355 681Q389 681 418 681T463 682T483 682Q499 682 499 672Q499 670 497 658Q492 641 487 638H485Q483 638 480 638T473 638T464 637T455 637Q416 636 405 634T387 623Q384 619 355 500Q348 474 340 442T328 395L324 380Q324 378 469 378H614L615 381Q615 384 646 504Q674 619 674 627T617 637Q594 637 587 639T580 648Q580 650 582 660Q586 677 588 679T604 682Q609 682 646 681T740 680Q802 680 835 681T871 682Q888 682 888 672Q888 645 876 638H874Q872 638 869 638T862 638T853 637T844 637Q805 636 794 634T776 623Q773 618 704 340T634 58Q634 51 638 51Q646 48 692 46H723Q729 38 729 37T726 19Q722 6 716 0H701Q664 2 567 2Q533 2 504 2T458 2T437 1Q420 1 420 10Q420 15 423 24Q428 43 433 45Q437 46 448 46H454Q481 46 514 49Q520 50 522 50T528 55T534 64T540 82T547 110T558 153Q565 181 569 198Q602 330 602 331T457 332H312L279 197Q245 63 245 58Q245 51 253 49T303 46H334Q340 38 340 37T337 19Q333 6 327 0H312Q275 2 178 2Q144 2 115 2T69 2T48 1Q31 1 31 10Q31 12 34 24Q39 43 44 45Q48 46 59 46H65Q92 46 125 49Q139 52 144 61Q147 65 216 339T285 628Q285 635 228 637Z"></path><path id="MJMATHI-4D" stroke-width="1" d="M289 629Q289 635 232 637Q208 637 201 638T194 648Q194 649 196 659Q197 662 198 666T199 671T201 676T203 679T207 681T212 683T220 683T232 684Q238 684 262 684T307 683Q386 683 398 683T414 678Q415 674 451 396L487 117L510 154Q534 190 574 254T662 394Q837 673 839 675Q840 676 842 678T846 681L852 683H948Q965 683 988 683T1017 684Q1051 684 1051 673Q1051 668 1048 656T1045 643Q1041 637 1008 637Q968 636 957 634T939 623Q936 618 867 340T797 59Q797 55 798 54T805 50T822 48T855 46H886Q892 37 892 35Q892 19 885 5Q880 0 869 0Q864 0 828 1T736 2Q675 2 644 2T609 1Q592 1 592 11Q592 13 594 25Q598 41 602 43T625 46Q652 46 685 49Q699 52 704 61Q706 65 742 207T813 490T848 631L654 322Q458 10 453 5Q451 4 449 3Q444 0 433 0Q418 0 415 7Q413 11 374 317L335 624L267 354Q200 88 200 79Q206 46 272 46H282Q288 41 289 37T286 19Q282 3 278 1Q274 0 267 0Q265 0 255 0T221 1T157 2Q127 2 95 1T58 0Q43 0 39 2T35 11Q35 13 38 25T43 40Q45 46 65 46Q135 46 154 86Q158 92 223 354T289 629Z"></path><path id="MJMATHI-68" stroke-width="1" d="M137 683Q138 683 209 688T282 694Q294 694 294 685Q294 674 258 534Q220 386 220 383Q220 381 227 388Q288 442 357 442Q411 442 444 415T478 336Q478 285 440 178T402 50Q403 36 407 31T422 26Q450 26 474 56T513 138Q516 149 519 151T535 153Q555 153 555 145Q555 144 551 130Q535 71 500 33Q466 -10 419 -10H414Q367 -10 346 17T325 74Q325 90 361 192T398 345Q398 404 354 404H349Q266 404 205 306L198 293L164 158Q132 28 127 16Q114 -11 83 -11Q69 -11 59 -2T48 16Q48 30 121 320L195 616Q195 629 188 632T149 637H128Q122 643 122 645T124 664Q129 683 137 683Z"></path><path id="MJMAIN-31" stroke-width="1" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path><path id="MJMAIN-3D" stroke-width="1" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path><path id="MJMAIN-30" stroke-width="1" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z"></path><path id="MJMATHI-43" stroke-width="1" d="M50 252Q50 367 117 473T286 641T490 704Q580 704 633 653Q642 643 648 636T656 626L657 623Q660 623 684 649Q691 655 699 663T715 679T725 690L740 705H746Q760 705 760 698Q760 694 728 561Q692 422 692 421Q690 416 687 415T669 413H653Q647 419 647 422Q647 423 648 429T650 449T651 481Q651 552 619 605T510 659Q484 659 454 652T382 628T299 572T226 479Q194 422 175 346T156 222Q156 108 232 58Q280 24 350 24Q441 24 512 92T606 240Q610 253 612 255T628 257Q648 257 648 248Q648 243 647 239Q618 132 523 55T319 -22Q206 -22 128 53T50 252Z"></path><path id="MJMAIN-28" stroke-width="1" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path><path id="MJMAIN-2C" stroke-width="1" d="M78 35T78 60T94 103T137 121Q165 121 187 96T210 8Q210 -27 201 -60T180 -117T154 -158T130 -185T117 -194Q113 -194 104 -185T95 -172Q95 -168 106 -156T131 -126T157 -76T173 -3V9L172 8Q170 7 167 6T161 3T152 1T140 0Q113 0 96 17Z"></path><path id="MJMAIN-29" stroke-width="1" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path><path id="MJMAIN-32" stroke-width="1" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path><path id="MJMATHI-41" stroke-width="1" d="M208 74Q208 50 254 46Q272 46 272 35Q272 34 270 22Q267 8 264 4T251 0Q249 0 239 0T205 1T141 2Q70 2 50 0H42Q35 7 35 11Q37 38 48 46H62Q132 49 164 96Q170 102 345 401T523 704Q530 716 547 716H555H572Q578 707 578 706L606 383Q634 60 636 57Q641 46 701 46Q726 46 726 36Q726 34 723 22Q720 7 718 4T704 0Q701 0 690 0T651 1T578 2Q484 2 455 0H443Q437 6 437 9T439 27Q443 40 445 43L449 46H469Q523 49 533 63L521 213H283L249 155Q208 86 208 74ZM516 260Q516 271 504 416T490 562L463 519Q447 492 400 412L310 260L413 259Q516 259 516 260Z"></path><path id="MJMATHI-4E" stroke-width="1" d="M234 637Q231 637 226 637Q201 637 196 638T191 649Q191 676 202 682Q204 683 299 683Q376 683 387 683T401 677Q612 181 616 168L670 381Q723 592 723 606Q723 633 659 637Q635 637 635 648Q635 650 637 660Q641 676 643 679T653 683Q656 683 684 682T767 680Q817 680 843 681T873 682Q888 682 888 672Q888 650 880 642Q878 637 858 637Q787 633 769 597L620 7Q618 0 599 0Q585 0 582 2Q579 5 453 305L326 604L261 344Q196 88 196 79Q201 46 268 46H278Q284 41 284 38T282 19Q278 6 272 0H259Q228 2 151 2Q123 2 100 2T63 2T46 1Q31 1 31 10Q31 14 34 26T39 40Q41 46 62 46Q130 49 150 85Q154 91 221 362L289 634Q287 635 234 637Z"></path><path id="MJMATHI-44" stroke-width="1" d="M287 628Q287 635 230 637Q207 637 200 638T193 647Q193 655 197 667T204 682Q206 683 403 683Q570 682 590 682T630 676Q702 659 752 597T803 431Q803 275 696 151T444 3L430 1L236 0H125H72Q48 0 41 2T33 11Q33 13 36 25Q40 41 44 43T67 46Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628ZM703 469Q703 507 692 537T666 584T629 613T590 629T555 636Q553 636 541 636T512 636T479 637H436Q392 637 386 627Q384 623 313 339T242 52Q242 48 253 48T330 47Q335 47 349 47T373 46Q499 46 581 128Q617 164 640 212T683 339T703 469Z"></path><path id="MJMATHI-4F" stroke-width="1" d="M740 435Q740 320 676 213T511 42T304 -22Q207 -22 138 35T51 201Q50 209 50 244Q50 346 98 438T227 601Q351 704 476 704Q514 704 524 703Q621 689 680 617T740 435ZM637 476Q637 565 591 615T476 665Q396 665 322 605Q242 542 200 428T157 216Q157 126 200 73T314 19Q404 19 485 98T608 313Q637 408 637 476Z"></path><path id="MJMATHI-6B" stroke-width="1" d="M121 647Q121 657 125 670T137 683Q138 683 209 688T282 694Q294 694 294 686Q294 679 244 477Q194 279 194 272Q213 282 223 291Q247 309 292 354T362 415Q402 442 438 442Q468 442 485 423T503 369Q503 344 496 327T477 302T456 291T438 288Q418 288 406 299T394 328Q394 353 410 369T442 390L458 393Q446 405 434 405H430Q398 402 367 380T294 316T228 255Q230 254 243 252T267 246T293 238T320 224T342 206T359 180T365 147Q365 130 360 106T354 66Q354 26 381 26Q429 26 459 145Q461 153 479 153H483Q499 153 499 144Q499 139 496 130Q455 -11 378 -11Q333 -11 305 15T277 90Q277 108 280 121T283 145Q283 167 269 183T234 206T200 217T182 220H180Q168 178 159 139T145 81T136 44T129 20T122 7T111 -2Q98 -11 83 -11Q66 -11 57 -1T48 16Q48 26 85 176T158 471L195 616Q196 629 188 632T149 637H144Q134 637 131 637T124 640T121 647Z"></path><path id="MJMATHI-77" stroke-width="1" d="M580 385Q580 406 599 424T641 443Q659 443 674 425T690 368Q690 339 671 253Q656 197 644 161T609 80T554 12T482 -11Q438 -11 404 5T355 48Q354 47 352 44Q311 -11 252 -11Q226 -11 202 -5T155 14T118 53T104 116Q104 170 138 262T173 379Q173 380 173 381Q173 390 173 393T169 400T158 404H154Q131 404 112 385T82 344T65 302T57 280Q55 278 41 278H27Q21 284 21 287Q21 293 29 315T52 366T96 418T161 441Q204 441 227 416T250 358Q250 340 217 250T184 111Q184 65 205 46T258 26Q301 26 334 87L339 96V119Q339 122 339 128T340 136T341 143T342 152T345 165T348 182T354 206T362 238T373 281Q402 395 406 404Q419 431 449 431Q468 431 475 421T483 402Q483 389 454 274T422 142Q420 131 420 107V100Q420 85 423 71T442 42T487 26Q558 26 600 148Q609 171 620 213T632 273Q632 306 619 325T593 357T580 385Z"></path><path id="MJMAIN-22EF" stroke-width="1" d="M78 250Q78 274 95 292T138 310Q162 310 180 294T199 251Q199 226 182 208T139 190T96 207T78 250ZM525 250Q525 274 542 292T585 310Q609 310 627 294T646 251Q646 226 629 208T586 190T543 207T525 250ZM972 250Q972 274 989 292T1032 310Q1056 310 1074 294T1093 251Q1093 226 1076 208T1033 190T990 207T972 250Z"></path><path id="MJMATHI-6E" stroke-width="1" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"></path><path id="MJMATHI-6F" stroke-width="1" d="M201 -11Q126 -11 80 38T34 156Q34 221 64 279T146 380Q222 441 301 441Q333 441 341 440Q354 437 367 433T402 417T438 387T464 338T476 268Q476 161 390 75T201 -11ZM121 120Q121 70 147 48T206 26Q250 26 289 58T351 142Q360 163 374 216T388 308Q388 352 370 375Q346 405 306 405Q243 405 195 347Q158 303 140 230T121 120Z"></path><path id="MJSZ1-220F" stroke-width="1" d="M158 656Q147 684 131 694Q110 707 69 710H55V750H888V710H874Q840 708 820 698T795 678T786 656V-155Q798 -206 874 -210H888V-250H570V-210H584Q618 -208 638 -197T663 -178T673 -155V710H270V277L271 -155Q283 -206 359 -210H373V-250H55V-210H69Q103 -208 123 -197T148 -178T158 -155V656Z"></path><path id="MJMATHI-69" stroke-width="1" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path><path id="MJSZ1-28" stroke-width="1" d="M152 251Q152 646 388 850H416Q422 844 422 841Q422 837 403 816T357 753T302 649T255 482T236 250Q236 124 255 19T301 -147T356 -251T403 -315T422 -340Q422 -343 416 -349H388Q359 -325 332 -296T271 -213T212 -97T170 56T152 251Z"></path><path id="MJSZ1-29" stroke-width="1" d="M305 251Q305 -145 69 -349H56Q43 -349 39 -347T35 -338Q37 -333 60 -307T108 -239T160 -136T204 27T221 250T204 473T160 636T108 740T60 807T35 839Q35 850 50 850H56H69Q197 743 256 566Q305 425 305 251Z"></path><path id="MJMAIN-2212" stroke-width="1" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z"></path><path id="MJSZ3-28" stroke-width="1" d="M701 -940Q701 -943 695 -949H664Q662 -947 636 -922T591 -879T537 -818T475 -737T412 -636T350 -511T295 -362T250 -186T221 17T209 251Q209 962 573 1361Q596 1386 616 1405T649 1437T664 1450H695Q701 1444 701 1441Q701 1436 681 1415T629 1356T557 1261T476 1118T400 927T340 675T308 359Q306 321 306 250Q306 -139 400 -430T690 -924Q701 -936 701 -940Z"></path><path id="MJSZ3-29" stroke-width="1" d="M34 1438Q34 1446 37 1448T50 1450H56H71Q73 1448 99 1423T144 1380T198 1319T260 1238T323 1137T385 1013T440 864T485 688T514 485T526 251Q526 134 519 53Q472 -519 162 -860Q139 -885 119 -904T86 -936T71 -949H56Q43 -949 39 -947T34 -937Q88 -883 140 -813Q428 -430 428 251Q428 453 402 628T338 922T245 1146T145 1309T46 1425Q44 1427 42 1429T39 1433T36 1436L34 1438Z"></path><path id="MJMATHI-70" stroke-width="1" d="M23 287Q24 290 25 295T30 317T40 348T55 381T75 411T101 433T134 442Q209 442 230 378L240 387Q302 442 358 442Q423 442 460 395T497 281Q497 173 421 82T249 -10Q227 -10 210 -4Q199 1 187 11T168 28L161 36Q160 35 139 -51T118 -138Q118 -144 126 -145T163 -148H188Q194 -155 194 -157T191 -175Q188 -187 185 -190T172 -194Q170 -194 161 -194T127 -193T65 -192Q-5 -192 -24 -194H-32Q-39 -187 -39 -183Q-37 -156 -26 -148H-6Q28 -147 33 -136Q36 -130 94 103T155 350Q156 355 156 364Q156 405 131 405Q109 405 94 377T71 316T59 280Q57 278 43 278H29Q23 284 23 287ZM178 102Q200 26 252 26Q282 26 310 49T356 107Q374 141 392 215T411 325V331Q411 405 350 405Q339 405 328 402T306 393T286 380T269 365T254 350T243 336T235 326L232 322Q232 321 229 308T218 264T204 212Q178 106 178 102Z"></path><path id="MJMATHI-46" stroke-width="1" d="M48 1Q31 1 31 11Q31 13 34 25Q38 41 42 43T65 46Q92 46 125 49Q139 52 144 61Q146 66 215 342T285 622Q285 629 281 629Q273 632 228 634H197Q191 640 191 642T193 659Q197 676 203 680H742Q749 676 749 669Q749 664 736 557T722 447Q720 440 702 440H690Q683 445 683 453Q683 454 686 477T689 530Q689 560 682 579T663 610T626 626T575 633T503 634H480Q398 633 393 631Q388 629 386 623Q385 622 352 492L320 363H375Q378 363 398 363T426 364T448 367T472 374T489 386Q502 398 511 419T524 457T529 475Q532 480 548 480H560Q567 475 567 470Q567 467 536 339T502 207Q500 200 482 200H470Q463 206 463 212Q463 215 468 234T473 274Q473 303 453 310T364 317H309L277 190Q245 66 245 60Q245 46 334 46H359Q365 40 365 39T363 19Q359 6 353 0H336Q295 2 185 2Q120 2 86 2T48 1Z"></path><path id="MJMAIN-33" stroke-width="1" d="M127 463Q100 463 85 480T69 524Q69 579 117 622T233 665Q268 665 277 664Q351 652 390 611T430 522Q430 470 396 421T302 350L299 348Q299 347 308 345T337 336T375 315Q457 262 457 175Q457 96 395 37T238 -22Q158 -22 100 21T42 130Q42 158 60 175T105 193Q133 193 151 175T169 130Q169 119 166 110T159 94T148 82T136 74T126 70T118 67L114 66Q165 21 238 21Q293 21 321 74Q338 107 338 175V195Q338 290 274 322Q259 328 213 329L171 330L168 332Q166 335 166 348Q166 366 174 366Q202 366 232 371Q266 376 294 413T322 525V533Q322 590 287 612Q265 626 240 626Q208 626 181 615T143 592T132 580H135Q138 579 143 578T153 573T165 566T175 555T183 540T186 520Q186 498 172 481T127 463Z"></path><path id="MJMAIN-2E" stroke-width="1" d="M78 60Q78 84 95 102T138 120Q162 120 180 104T199 61Q199 36 182 18T139 0T96 17T78 60Z"></path><path id="MJMAIN-35" stroke-width="1" d="M164 157Q164 133 148 117T109 101H102Q148 22 224 22Q294 22 326 82Q345 115 345 210Q345 313 318 349Q292 382 260 382H254Q176 382 136 314Q132 307 129 306T114 304Q97 304 95 310Q93 314 93 485V614Q93 664 98 664Q100 666 102 666Q103 666 123 658T178 642T253 634Q324 634 389 662Q397 666 402 666Q410 666 410 648V635Q328 538 205 538Q174 538 149 544L139 546V374Q158 388 169 396T205 412T256 420Q337 420 393 355T449 201Q449 109 385 44T229 -22Q148 -22 99 32T50 154Q50 178 61 192T84 210T107 214Q132 214 148 197T164 157Z"></path><path id="MJAMS-45" stroke-width="1" d="M12 666Q12 675 24 683H582Q590 680 593 672V588Q593 514 591 502T575 490Q567 490 563 495T555 517Q552 556 517 590Q486 623 445 634T340 648H282Q266 636 264 620T260 492V370H277Q329 375 358 391T404 439Q420 480 420 506Q420 529 436 529Q445 529 451 521Q455 517 455 361Q455 333 455 298T456 253Q456 217 453 207T437 197Q420 196 420 217Q420 240 406 270Q377 328 284 335H260V201Q261 174 261 134Q262 73 264 61T278 38Q281 36 282 35H331Q400 35 449 50Q571 93 602 179Q605 203 622 203Q629 203 634 197T640 183Q638 181 624 95T604 3L600 -1H24Q12 5 12 16Q12 35 51 35Q92 38 97 52Q102 60 102 341T97 632Q91 645 51 648Q12 648 12 666ZM137 341Q137 131 136 89T130 37Q129 36 129 35H235Q233 41 231 48L226 61V623L231 635L235 648H129Q132 641 133 638T135 603T137 517T137 341ZM557 603V648H504Q504 646 515 639Q527 634 542 619L557 603ZM420 317V397L406 383Q394 370 380 363L366 355Q373 350 382 346Q400 333 409 328L420 317ZM582 61L586 88Q585 88 582 83Q557 61 526 46L511 37L542 35H577Q577 36 578 39T580 49T582 61Z"></path><path id="MJSZ1-2211" stroke-width="1" d="M61 748Q64 750 489 750H913L954 640Q965 609 976 579T993 533T999 516H979L959 517Q936 579 886 621T777 682Q724 700 655 705T436 710H319Q183 710 183 709Q186 706 348 484T511 259Q517 250 513 244L490 216Q466 188 420 134T330 27L149 -187Q149 -188 362 -188Q388 -188 436 -188T506 -189Q679 -189 778 -162T936 -43Q946 -27 959 6H999L913 -249L489 -250Q65 -250 62 -248Q56 -246 56 -239Q56 -234 118 -161Q186 -81 245 -11L428 206Q428 207 242 462L57 717L56 728Q56 744 61 748Z"></path><path id="MJMAIN-2217" stroke-width="1" d="M229 286Q216 420 216 436Q216 454 240 464Q241 464 245 464T251 465Q263 464 273 456T283 436Q283 419 277 356T270 286L328 328Q384 369 389 372T399 375Q412 375 423 365T435 338Q435 325 425 315Q420 312 357 282T289 250L355 219L425 184Q434 175 434 161Q434 146 425 136T401 125Q393 125 383 131T328 171L270 213Q283 79 283 63Q283 53 276 44T250 35Q231 35 224 44T216 63Q216 80 222 143T229 213L171 171Q115 130 110 127Q106 124 100 124Q87 124 76 134T64 161Q64 166 64 169T67 175T72 181T81 188T94 195T113 204T138 215T170 230T210 250L74 315Q65 324 65 338Q65 353 74 363T98 374Q106 374 116 368T171 328L229 286Z"></path></defs></svg></div><div id="wmd-preview" class="wmd-preview"><div class="md-section-divider"></div><div class="md-section-divider"></div><h1 data-anchor-id="mtia" id="tuple-space-explosion-a-denial-of-service-attack-against-a-software-packet-classifier">Tuple Space Explosion: A Denial-of-Service Attack Against a Software Packet Classifier</h1><p data-anchor-id="yhgm"><code>security</code></p><div class="md-section-divider"></div><h2 data-anchor-id="8qfs" id="csikor-l-divakaran-d-m-kang-m-s-et-al-tuple-space-explosion-a-denial-of-service-attack-against-a-software-packet-classifierj-2019acm-conext-2019引用还没出来">Csikor L, Divakaran D M, Kang M S, et al. Tuple Space Explosion: A Denial-of-Service Attack Against a Software Packet Classifier[J]. 2019.ACM CoNext 2019，引用还没出来</h2><p data-anchor-id="i7kw">是一个B类，但是文章写得还是不错的，里面涉及的陌生东西多了点，所以本篇看了很久。本文通过评估TSS算法的有效性提出了TSE攻击，该攻击会大大降低OVS的性能，在知道OVS的分类策略的情况下能用很少的包就能进行攻击，不知道策略的情况下也能通过随机包内容的方式进行攻击，攻击效果可观。本文也提出了一个临时的防御方法：MFCGuard。</p><p data-anchor-id="m9db">。</p><div class="md-section-divider"></div><h1 data-anchor-id="95x1" id="introduction">Introduction</h1><p data-anchor-id="futt">当前的包分类算法：Tuple Space Search，本文提出的TES攻击能大大降低OVS的性能。与当前现有的低速攻击不同：本TSE不需具体的流量模式，只需要随机的包头和内容，随机的到达时间，本文是针对包分类器的弱点进行攻击。由于攻击的是包分类器，因此很难被检测，要防御TES就需要部署能够抵御TES攻击的分类器，如：[3]，[58]，[10]。本文提出MFCGuard方法，它能动态移除空间重要性低的entry以临时解决。</p><div class="md-section-divider"></div><h2 data-anchor-id="h97j" id="ovs">OVS</h2><p data-anchor-id="qua9"><strong>OVS：</strong>高性能软件交换机，可由OF和RFC7047协议远程控制，广泛在云端使用。OVS的流表中每一项由wildcard rule和action组成。若一个包匹配多个流表，则先匹配到的优先级高。所有的rule不相交会使包分类更简单称该情况为：<strong>order-independent</strong>,然而<strong>order-dependent</strong>可支持通配符，使规则配置更便捷。</p><div class="md-section-divider"></div><h2 data-anchor-id="nxhd" id="tss-for-fast-packet-classification">TSS for Fast Packet Classification</h2><p data-anchor-id="odhp">OVS采用的地fast path/slow path划分原则，fast path有两层流表缓存，而slow path有完整的流表查找服务.fast path：流表匹配项的包走的path；slow path:无流表的包需要缓存，如：每个流的第一个包。 <br>
这两种path共同组成一个流的开销，可以提高性能。fast path中有microflow cachemegaflow cache，第一个缓存精确差找，第二种缓存即为TSS的查找方式,称为Megaflow cache(MFC)，见<strong>Tuple Space Search</strong>算法。MFC通过单个megaflow保存能被相同掩码匹配的包，然而TSS并不知道流表的优先级，因此slow path要保证MFC的每一个entry不相交，这就有可能会导致指数复杂度。</p><div class="md-section-divider"></div><h1 data-anchor-id="y2ae" id="tuple-space-explosionoverview">Tuple Space Explosion:Overview</h1><div class="md-section-divider"></div><h2 data-anchor-id="er6i" id="threat-model">Threat Model</h2><p data-anchor-id="08nc">Tenants有的会使用CMS API来设定控制列表(ACL)。假设攻击者知道数据平面算法，则攻击者可以发送任意合法头的包。攻击目标：发送包到OVS以消耗可用的资源使合法用户断连。</p><div class="md-section-divider"></div><h2 data-anchor-id="0xwl" id="dos-with-excessive-mfc-masks">DoS with Excessive MFC Masks</h2><p data-anchor-id="q2sv">假设一个规则有3个位，MFC是一个key-mask的无序集元素为：C={K,M}，M为掩码来找头相应的位，K为在掩码相应位中要匹配的位的键值。根据TSS算法，需要维护distinctive掩码列表<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-1-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -726.9033013280564 1201.5 798.8066026561128" style="width: 2.778ex; height: 1.889ex; vertical-align: -0.222ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJCAL-4D"></use></g></svg></span><script type="math/tex" id="MathJax-Element-1">\mathcal{M}</script>，并对每一个<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-2-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -726.9033013280564 3303.0555555555557 798.8066026561128" style="width: 7.667ex; height: 1.889ex; vertical-align: -0.222ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-6D"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2208" x="1156" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJCAL-4D" x="2101" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-2">m \in \mathcal{M}</script>都有一个hash表<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-3-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -704.9033013280564 1675.0227804176548 876.5137094372993" style="width: 3.889ex; height: 2ex; vertical-align: -0.444ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-48"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-4D" x="1175" y="-213"></use></g></svg></span><script type="math/tex" id="MathJax-Element-3">H_M</script>用来存储和查找对应掩码M的键K。假设规则HYP的头<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-4-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -715.9033013280564 3865.962499539423 887.5137094372993" style="width: 9ex; height: 2.111ex; vertical-align: -0.444ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-68"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-31" x="815" y="-213"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-3D" x="1308" y="0"></use><g transform="translate(2364,0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-30"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-30" x="500" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-31" x="1001" y="0"></use></g></g></svg></span><script type="math/tex" id="MathJax-Element-4">h_1 = 001</script>,初始化时MFC为空，则往MFC插入一个新的key-mask对<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-5-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -771.9033013280564 6730.629166206089 1043.8066026561128" style="width: 15.667ex; height: 2.444ex; vertical-align: -0.778ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-43"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-31" x="1011" y="-213"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-3D" x="1447" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-28" x="2503" y="0"></use><g transform="translate(2892,0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-30"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-30" x="500" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-31" x="1001" y="0"></use></g><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2C" x="4394" y="0"></use><g transform="translate(4839,0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-31"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-31" x="500" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-31" x="1001" y="0"></use></g><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-29" x="6341" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-5">C_1=(001,111)</script>.这时当一个新头<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-6-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -715.9033013280564 1030.406943983867 887.5137094372993" style="width: 2.444ex; height: 2.111ex; vertical-align: -0.444ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-68"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-32" x="815" y="-213"></use></g></svg></span><script type="math/tex" id="MathJax-Element-6">h_2</script>到来时会先在M中匹配再对M相对应的hash包<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-7-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -704.9033013280564 1675.0227804176548 876.5137094372993" style="width: 3.889ex; height: 2ex; vertical-align: -0.444ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-48"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-4D" x="1175" y="-213"></use></g></svg></span><script type="math/tex" id="MathJax-Element-7">H_M</script>,查找成功，则返回cache hit,否则找下一个M。对于<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-8-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -715.9033013280564 3865.962499539423 887.5137094372993" style="width: 9ex; height: 2.111ex; vertical-align: -0.444ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-68"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-32" x="815" y="-213"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-3D" x="1308" y="0"></use><g transform="translate(2364,0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-31"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-31" x="500" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-31" x="1001" y="0"></use></g></g></svg></span><script type="math/tex" id="MathJax-Element-8">h_2=111</script>，我们先匹配<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-9-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -771.9033013280564 8163.9624995394215 1043.8066026561128" style="width: 19ex; height: 2.444ex; vertical-align: -0.778ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-28"></use><g transform="translate(389,0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-68"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-32" x="815" y="-213"></use></g><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-41" x="1419" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-4E" x="2170" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-44" x="3058" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-4D" x="3887" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-29" x="4938" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-3D" x="5606" y="0"></use><g transform="translate(6662,0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-31"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-31" x="500" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-31" x="1001" y="0"></use></g></g></svg></span><script type="math/tex" id="MathJax-Element-9">(h_2 AND M)=111</script>,在<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-10-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -704.9033013280564 2286.4069439838668 876.5137094372993" style="width: 5.333ex; height: 2ex; vertical-align: -0.444ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-48"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-31" x="1175" y="-213"></use><g transform="translate(1285,0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-31"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-31" x="500" y="0"></use></g></g></svg></span><script type="math/tex" id="MathJax-Element-10">H_111</script>中查找，因为查找失败，因此cache miss，因此将会到slow path中找到drop rule，这时便会插入新的MFC项到fast path.对于这个新的entry需要保证的时：</p><ul data-anchor-id="b5f2">
<li>h maches C</li>
<li>C与集中其他项无交集</li>
</ul><p data-anchor-id="iqfp">因此<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-11-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -715.9033013280564 3865.962499539423 887.5137094372993" style="width: 9ex; height: 2.111ex; vertical-align: -0.444ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-68"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-32" x="815" y="-213"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-3D" x="1308" y="0"></use><g transform="translate(2364,0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-31"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-31" x="500" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-31" x="1001" y="0"></use></g></g></svg></span><script type="math/tex" id="MathJax-Element-11">h_2=111</script>会产生一个新的key-mask对<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-12-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -771.9033013280564 6730.629166206089 1043.8066026561128" style="width: 15.667ex; height: 2.444ex; vertical-align: -0.778ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-43"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-32" x="1011" y="-213"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-3D" x="1447" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-28" x="2503" y="0"></use><g transform="translate(2892,0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-31"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-31" x="500" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-31" x="1001" y="0"></use></g><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2C" x="4394" y="0"></use><g transform="translate(4839,0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-31"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-31" x="500" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-31" x="1001" y="0"></use></g><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-29" x="6341" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-12">C_2=(111,111)</script>或<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-13-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -771.9033013280564 6730.629166206089 1043.8066026561128" style="width: 15.667ex; height: 2.444ex; vertical-align: -0.778ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-43"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-32" x="1011" y="-213"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-3D" x="1447" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-28" x="2503" y="0"></use><g transform="translate(2892,0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-31"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-31" x="500" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-31" x="1001" y="0"></use></g><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2C" x="4394" y="0"></use><g transform="translate(4839,0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-31"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-30" x="500" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-30" x="1001" y="0"></use></g><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-29" x="6341" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-13">C_2=(111,100)</script>。可见这个C的数量会随head的位宽度增加而世增。<strong>如：</strong><img src="https://s2.ax1x.com/2019/11/22/MoXn4U.png" alt="MoXn4U.png" title=""> <br>
我们就是利用这个缺陷进行攻击，命名为Tuple Space Explosion(TSE) <br>
。下面提供基于当前攻击者对ACL的控制而发动的两种TSE攻击方法。</p><div class="md-section-divider"></div><h2 data-anchor-id="dw8k" id="two-approaches-of-the-tse-attack">Two Approaches of the TSE Attack</h2><p data-anchor-id="uhwz">每个租户看似自己都有一个OVS，其实这些OVS都被相同的管理程序管理。</p><ul data-anchor-id="t7n8">
<li>Co-located TSE:攻击者可以租云端资源，这样他就可以插ACL到他自己的OVS。这样的话共享的MFC就会被新的mask影响。当然发生的条件为所有的OVS被相同的管理程序管理</li>
<li>General TSE：攻击者不能租用云端资源，也不知道ACL的相关知识。此时本文研究的为要达到与Co-located TSE相同的效果需要how much more effort。</li>
</ul><div class="md-section-divider"></div><h2 data-anchor-id="faej" id="space-time-complexity-of-tss">SPACE-TIME COMPLEXITY of TSS</h2><p data-anchor-id="1224">以OVS为例分析TSS的空间-时间复杂度的trade-off。时间复杂度：掩码越多越慢；空间复杂度：由MFC的entry数量决定。观察结果：时间复杂度与掩码数相关，为O(|M|),空间复杂度成entry数有关，为O(|C|)。下面以前面的HYP3位协议为例来说明复杂度爆炸。</p><div class="md-section-divider"></div><h3 data-anchor-id="83q4" id="maximize-mfc-maskssingle-header">Maximize MFC Masks:Single Header</h3><p data-anchor-id="l4vr">在只允许一个头域的网络策略下，如：只允许001,禁止其他的头域，则用TSS构建MFC可能的策略有：</p><ul data-anchor-id="a1t8">
<li><strong>invalid strategy</strong>只往MFC中插两个entry,如图1.这违背了不变量独立的原则，因此不可行。<img src="https://s2.ax1x.com/2019/11/22/M7jhWT.png" alt="M7jhWT.png" title=""></li>
<li><strong>Exact-match strategy</strong>:一个掩码，8个key，如图2,最优化时间复杂度，但空间复杂度很高。</li>
<li><strong>wildcarding strategy:</strong>这个有点复杂。该方法将allow的规则用exact-match entry来匹配，然后用key-mask对来测试每一个位，如图3 <br>
<img src="https://s2.ax1x.com/2019/11/22/M7zOkn.png" alt="M7zOkn.png">先检查第一位是否被设定，是就丢弃，否则检查下一位，本方法的目的是最大化rule，最小化hash。最后结果有4个entry和3个mask.它把megaflow数从8降到了4,但增加了分类时间，可见每个策略有不同的时间，空间复杂度调和方式</li>
</ul><p data-anchor-id="l5t3"><strong>Theorem4.1</strong>:对于w位单匹配头域，单个允许rule和缺少阻止rule，最优时间复杂度：<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-14-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -771.9033013280564 2064 1043.8066026561128" style="width: 4.778ex; height: 2.444ex; vertical-align: -0.778ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-4F"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-28" x="763" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-6B" x="1153" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-29" x="1674" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-14">O(k)</script>，空间复杂度：<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-15-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -1009.4393013280566 3382.75 1281.3426026561128" style="width: 7.889ex; height: 3ex; vertical-align: -0.778ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-4F"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-28" x="763" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-6B" x="1153" y="0"></use><g transform="translate(1674,0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-32"></use><g transform="translate(500,434)"><g transform="translate(120,0)"><rect stroke="none" width="478" height="60" x="0" y="146"></rect><use transform="scale(0.5000000000000001)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-77" x="119" y="664"></use><use transform="scale(0.5000000000000001)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-6B" x="217" y="-641"></use></g></g></g><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-29" x="2993" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-15">O(k2^{\frac{w}{k}})</script>，这里的w为位数，k为平衡时间与空间复杂度的参数，k=1时时间复杂度最小空间复杂度最大；k=w恰好反之。单个头域OVS中倾向最小化内存使用，有时也会最小化查询时间。</p><div class="md-section-divider"></div><h3 data-anchor-id="ahql" id="maximize-mfc-masks-mlti-headers">Maximize MFC Masks: Mlti Headers</h3><p data-anchor-id="tv18">多头域的情况如图4,只有在HYP 不为001且HYP2不为111时丢弃。因此会产生3*4+1=13个masks。</p><p data-anchor-id="9s44"><strong>Theorem4.2</strong>:n个头域，位数分别人<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-16-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -464.9033013280564 6256.598176736923 681.8066026561128" style="width: 14.556ex; height: 1.556ex; vertical-align: -0.556ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-77"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-31" x="1013" y="-213"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2C" x="1170" y="0"></use><g transform="translate(1615,0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-77"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-32" x="1013" y="-213"></use></g><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2C" x="2785" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-22EF" x="3231" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2C" x="4570" y="0"></use><g transform="translate(5015,0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-77"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-6E" x="1013" y="-213"></use></g></g></svg></span><script type="math/tex" id="MathJax-Element-16">w_1,w_2,\cdots,w_n</script>组成n个allow-rules,每个单头域都是exact-match并且defaultDeny，中最优时间得杂度为：<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-17-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -871.4033013280564 3723.777452466571 1242.8066026561128" style="width: 8.667ex; height: 2.889ex; vertical-align: -1ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-6F"></use><g transform="translate(485,0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJSZ1-28"></use><g transform="translate(458,0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJSZ1-220F"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-69" x="1335" y="-405"></use></g><g transform="translate(1913,0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-6B"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-69" x="737" y="-213"></use></g><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJSZ1-29" x="2779" y="-1"></use></g></g></svg></span><script type="math/tex" id="MathJax-Element-17">o\left(\prod_{i} k_{i}\right)</script>，最优空间复杂度为：<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-18-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -1471.4033013280564 9309.555230244348 2442.806602656113" style="width: 21.667ex; height: 5.667ex; vertical-align: -2.333ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-4F"></use><g transform="translate(763,0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJSZ1-28"></use><g transform="translate(458,0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJSZ1-220F"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-69" x="1335" y="-405"></use></g><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJSZ1-29" x="1747" y="-1"></use></g><g transform="translate(2969,0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-6B"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-69" x="737" y="-213"></use></g><g transform="translate(3835,0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJSZ3-28"></use><g transform="translate(736,0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-32"></use><g transform="translate(500,592)"><g transform="translate(120,0)"><rect stroke="none" width="701" height="60" x="0" y="146"></rect><g transform="translate(60,491)"><use transform="scale(0.5000000000000001)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-77"></use><use transform="scale(0.5000000000000001)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-69" x="716" y="-318"></use></g><g transform="translate(108,-321)"><use transform="scale(0.5000000000000001)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-6B"></use><use transform="scale(0.5000000000000001)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-69" x="521" y="-318"></use></g></g></g></g><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2212" x="2500" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-31" x="3500" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJSZ3-29" x="4001" y="-1"></use></g><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJSZ3-29" x="8573" y="-1"></use></g></svg></span><script type="math/tex" id="MathJax-Element-18">\left.O\left(\prod_{i}\right) k_{i}\left(2^{\frac{w_{i}}{k_{i}}}-1\right)\right)</script>。同样，<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-19-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -715.9033013280564 865.8053928999522 895.2918840303514" style="width: 2ex; height: 2.111ex; vertical-align: -0.556ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-6B"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-69" x="737" y="-213"></use></g></svg></span><script type="math/tex" id="MathJax-Element-19">k_i</script>为均衡时间与空间的参数。</p><div class="md-section-divider"></div><h1 data-anchor-id="uaus" id="tse">TSE</h1><div class="md-section-divider"></div><h2 data-anchor-id="2h9m" id="co-located-tse">Co-located TSE</h2><p data-anchor-id="6pl5"><img src="https://s2.ax1x.com/2019/11/24/MLOKAA.png" alt="MLOKAA.png" title=""></p><div class="md-section-divider"></div><h3 data-anchor-id="tl5u" id="adversarial-packet-trace">adversarial Packet TRAce</h3><ul data-anchor-id="tfgb">
<li><strong>single Header</strong>:生成包的方法：匹配规则一个包，将每一位反转后再各生成一个包，如图1中的001则要生成的包有：{001,101,011,000}.</li>
<li><strong>Multiple Header</strong>:规则见图4,同上，依HYP和HYP2的规则列表再将他们外乘。忽视掉每二个allow rule中不产生mask的包，如图像中的#2-#4,#14-#16。</li>
</ul><div class="md-section-divider"></div><h3 data-anchor-id="rv38" id="practical-acls">Practical ACLs</h3><p data-anchor-id="ct3w">攻击的有效性取决于攻击者在数据平面造成的掩码数，而掩码数又取决于被网络策略所匹配的位宽和头域的值。本文使用3个IP头域作为目标，如图6. <br>
<img src="https://s2.ax1x.com/2019/11/23/MH7ZFS.png" alt="MH7ZFS.png"></p><ul data-anchor-id="umqh">
<li>Baseline:流表中只有1条规则来允许租户的服务，无恶意流进入系统，因此MFC masks数：1；这种情景表明S在正常操作情况下的全部capacity并可用于测量其他用例中测量服务降级的基线。</li>
<li>DP：攻击DP，再扩展到SPDP和SIPDP，攻击两个port产生的masks数：16*16=256；攻击源IP和port产生的mask数为：32*16=512.</li>
<li>full-blown attack:攻击SIPDPSP，可产生的mask数为：8200</li>
</ul><p data-anchor-id="6plp">最终，攻击包中加入一些不重要的头域以提高熵。</p><div class="md-section-divider"></div><h3 data-anchor-id="usso" id="enviromnments-and-setup">Enviromnments and Setup</h3><p data-anchor-id="p3ts">先测试单个实现TSS的OVS对TSE攻击的情况，再看真实的有管理程序特管理的OVS的情况，真实环境使用的为：Openstack和Kubernetes。配置信息见表1.<img src="https://s2.ax1x.com/2019/11/23/MHqfX9.png" alt="MHqfX9.png"> <br>
通过模拟真实去部署的管道来测单个OVS的吞吐量，架构如图7. <br>
<a href="https://imgchr.com/i/MHqHfO" target="_blank"><img src="https://s2.ax1x.com/2019/11/23/MHqHfO.md.png" alt="MHqHfO.md.png"></a> <br>
云数据中心由2个服务器来分担租户的工作量，受害者插入ACL-V使其公共服务可用，同时V2为另一个可用服务；攻击者在V1外租资源，其插入ACL-A以保证资源A1服务可用。然而攻击者使用TSE插规则使得MFC产生大量mask，从而降低其他租户服务的可用性。</p><div class="md-section-divider"></div><h3 data-anchor-id="jl2n" id="synthetic-tests">Synthetic tests</h3><p data-anchor-id="avtq">在Data Center中使用OVS作两个服务的程序，本文在V1和V2间跑iperf作为良性流量，若性能降级则表明攻击产生了效果。OVS的流表是根据图6中的ACL手动启动的。 <br>
<strong>下面说明当MFC的mask数增加时对OVS的吞吐量有怎样的影响，并讨论NIC drive offloading对该攻击的缓解程度</strong>。 <br>
图9a中x为MFC的mask数，Y为相关的吞吐量，坐标大小为log scale的。 <br>
<a href="https://imgchr.com/i/MLOB90" target="_blank"><img src="https://s2.ax1x.com/2019/11/24/MLOB90.md.png" alt="MLOB90.md.png"></a> <br>
其中，x轴的标签数据为15,260,516,8200分别用DP，SPDP，SIPDP，SDPSPDP表标。对于NIC的jumbo fram,generic transmit/receive offload，full hardware offloading是否使用对攻击结果有一定的影响。结果为：对于17个masks时在GRO ON,FHO ON,GRO OFF三种情况下分别将原吞吐量降低到：97%，88%，53%.当有260mask数时结果为：95%,43%,10%；当超过500mask数时结果为：76%，29%，4.7%;当超过8000mask数时，结果为：3.9%，2.1%，0.2%. <br>
第二个实验中y轴为1GBTCP流的完成时间，GRO OFF，坐标轴为log scale，结果为：流的完成时间增长速度为mask数增长的一半。<strong>该实验并未提供图。</strong> <br>
图8a为3个平行TCP流在SIPDIP，TCP offloading off的情况下的结果。 <br>
<a href="https://imgchr.com/i/MLjkLD" target="_blank"><img src="https://s2.ax1x.com/2019/11/24/MLjkLD.md.png" alt="MLjkLD.md.png" title=""></a> <br>
攻击者从t1到t2活动，注入速度为100包/s,将受害者的流量从9.7Gbps降到了0.5Gbps，从t2之后10s victim恢复，因为10s为MFS的空间超时时间。 <br>
攻击造成的伤害程度取决于注入ACL的类型，OVS版本，NIC的配置。如：在IPV6中用SIPDIP攻击只有少量的mask产生，但有大量的entry，因此该方法作用并非降低流量而是消耗内存和CPU。下面测量真实条件（OpenStack,Kubernetes）下TSE效果。</p><ul data-anchor-id="xuux">
<li>jumbo frame:大帧；</li>
<li>generic transmit/receive offload(GRO ON):将TCP包放到一个大的buffer里。</li>
<li>full hardware offloading(FHO ON):好像是一个硬件转发的设备。</li>
</ul><div class="md-section-divider"></div><h3 data-anchor-id="oqg3" id="openstack">OpenStack</h3><p data-anchor-id="52t8">在OpenStack中使用表1的配置，使用OVN integration[72];攻击者和受害者的负载隔离。它的CMS API只允SIPDP攻击情景攻击者发100pps，攻击时间为前60s和90s-120s。受害者在30s时加入UDP iperf，可铜陵攻击会大大降低性能。受可在停止攻击后10s恢复。<strong>第二次攻击对长流影响较小，这种情况在OpenStack版中可铜陵，联系OVS作者他们声明这是个不稳定版。</strong>结果可见图8b.</p><div class="md-section-divider"></div><h3 data-anchor-id="n7r7" id="kubernetes">Kubernetes</h3><p data-anchor-id="95k9">使用OVN integration[68],拓扑与之前相同，供应server的box使用virtio网络链路连接，其支持1GB率。使用SIPSPDP攻击，结果如图8c.在t1时发1000pps包，t2时注入ACL以触发大量MFC entry，t4时攻击者发送率提高到2000导致整个网络无法使用。</p><div class="md-section-divider"></div><h2 data-anchor-id="e0ma" id="generas-tse">Generas TSE</h2><p data-anchor-id="58ew">本部分计论在未知ACL时如何构建包，展示能实现MFC mask数量的下限。</p><div class="md-section-divider"></div><h2 data-anchor-id="hk5s" id="adversary-packet-trace">Adversary Packet Trace</h2><p data-anchor-id="ybws">若使用穷举法会产生大量流量，因此本文使用随机生成包，如在SIPDP攻击方案中随机生成SIP和DP的内容。下面分析一个合法的随机包会增加MFC entry数量的可能性，以及给定数量的随机包会产生多少的MFC mask。</p><p data-anchor-id="rxn2"><strong>single Header</strong>：在图3中可见当头长度为h时击中概率为<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-20-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="-38.5 -1047.3953811606702 6758.17936404686 1594.7907623213405" style="width: 15.667ex; height: 3.667ex; vertical-align: -1.333ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-70"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-6B" x="712" y="-213"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-28" x="972" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-4D" x="1361" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-46" x="2413" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-43" x="3162" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-29" x="3923" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-3D" x="4590" y="0"></use><g transform="translate(5766,0)"><rect stroke="none" width="832" height="60" x="0" y="220"></rect><g transform="translate(73,400)"><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-32"></use><use transform="scale(0.5000000000000001)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-6B" x="707" y="557"></use></g><g transform="translate(60,-526)"><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-32"></use><use transform="scale(0.5000000000000001)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-68" x="707" y="557"></use></g></g></g></svg></span><script type="math/tex" id="MathJax-Element-20">p_k(MFC)=\frac{2^k}{2^h}</script>。k为给定entry的通配符的位数。如图3中#entry,<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-21-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="-38.5 -1033.3953811606702 9318.885677197497 1566.2907623213403" style="width: 21.667ex; height: 3.667ex; vertical-align: -1.333ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-70"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-32" x="712" y="-213"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-28" x="957" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-4D" x="1346" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-46" x="2398" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-43" x="3147" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-29" x="3908" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-3D" x="4575" y="0"></use><g transform="translate(5751,0)"><rect stroke="none" width="794" height="60" x="0" y="220"></rect><g transform="translate(60,400)"><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-32"></use><use transform="scale(0.5000000000000001)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-32" x="707" y="557"></use></g><g transform="translate(60,-512)"><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-32"></use><use transform="scale(0.5000000000000001)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-33" x="707" y="557"></use></g></g><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-3D" x="6944" y="0"></use><g transform="translate(8000,0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-30"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2E" x="500" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-35" x="779" y="0"></use></g></g></svg></span><script type="math/tex" id="MathJax-Element-21">p_2(MFC)=\frac{2^2}{2^3}=0.5</script>。于n个生成的包，有一个击中的概率为：<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-22-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="-38.5 -812.839127104508 15920.95748253183 1197.820223181485" style="width: 37ex; height: 2.778ex; vertical-align: -1ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-70"></use><g transform="translate(503,-187)"><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-6B" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2C" x="911" y="0"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-6E" x="1189" y="0"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-29" x="1790" y="0"></use></g><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-28" x="2144" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-4D" x="2534" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-46" x="3585" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-43" x="4335" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-29" x="5095" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-3D" x="5762" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-31" x="6819" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2212" x="7541" y="0"></use><g transform="translate(8542,0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-28"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-31" x="389" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2212" x="1112" y="0"></use><g transform="translate(2112,0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-70"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-6B" x="712" y="-213"></use></g><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-28" x="3085" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-4D" x="3474" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-46" x="4526" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-43" x="5275" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-29" x="6036" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-29" x="6425" y="0"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-6E" x="9638" y="675"></use></g></g></svg></span><script type="math/tex" id="MathJax-Element-22">p_{(k, n)}(M F C)=1-\left(1-p_{k}(M F C)\right)^{n}</script> <br>
MFC的mask数的期望为：<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-23-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -990.3229291823314 17193.84707177399 1375.3040252593087" style="width: 39.889ex; height: 3.222ex; vertical-align: -1ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJAMS-45"></use><g transform="translate(667,-187)"><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-6B" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2C" x="911" y="0"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-6E" x="1189" y="0"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-29" x="1790" y="0"></use></g><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-28" x="2308" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-4D" x="2698" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-46" x="3749" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-43" x="4499" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-29" x="5259" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-3D" x="5926" y="0"></use><g transform="translate(6983,0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJSZ1-2211"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-68" x="1494" y="675"></use><g transform="translate(1056,-287)"><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-6B"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-3D" x="521" y="0"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-30" x="1300" y="0"></use></g></g><g transform="translate(9579,0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-43"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-6B" x="1011" y="-213"></use></g><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2217" x="10985" y="0"></use><g transform="translate(11708,0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-70"></use><g transform="translate(503,-187)"><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-28"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-6B" x="389" y="0"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2C" x="911" y="0"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-6E" x="1189" y="0"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-29" x="1790" y="0"></use></g></g><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-28" x="13853" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-4D" x="14242" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-46" x="15294" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-43" x="16043" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-29" x="16804" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-23">\mathbb{E}_{(k, n)}(M F C)=\sum_{k=0}^{h} C_{k} * p_{(k, n)}(M F C)</script> <br>
这里的<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-24-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -726.9033013280564 1184.2561863887845 906.2918840303514" style="width: 2.778ex; height: 2.111ex; vertical-align: -0.556ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-43"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-6B" x="1011" y="-213"></use></g></svg></span><script type="math/tex" id="MathJax-Element-24">C_k</script>表示对于一个给定的k有同的MFC entry数。 <br>
<strong>Multiple headers</strong>见附录。</p><div class="md-section-divider"></div><h3 data-anchor-id="z1h3" id="synthetic-tests-1">Synthetic Tests</h3><p data-anchor-id="67wg">相同的实验设置，实验结果见图9b。x轴为生成的随机包个数，y轴为期望和产生的mask数的测量，可见：组成ACL的头域越多，相同包数生成的MFC entry数就越多。在有50000个包时大约生成的MFC mask数在DP，SPDP，SIPDP，SIPDPSP情况下有：16,121,122,581个。攻击效果为：GRO OFF:52%(97% GRO ON,88% FHO,60% UDP),12%(96% GRO ON,87% FHO,15.8% UDP),1%(83 GRO ON,25.5% FHO,3.25% UDP)。可见该方法最终可以得到近似Co-located TSE的效果。</p><div class="md-section-divider"></div><h1 data-anchor-id="eano" id="migigation">Migigation</h1><p data-anchor-id="39y5">当前大环境下OVS使用越来越广泛，而TES攻击则对OVS十分有影响。TES暴露了TSS算法的复杂度缺陷，因此TSS的其他程序也有可能会受到影响。本文攻击由安全团队提出的解决方案并不十分可行，如：1.不使用ACL实现；其他的实现也许也会受到攻击；2.使用高性能网关应用；它在DC的内部无法生效；3.将MFC功能关闭；MFC是目前性能最高的；4.通过DPDK-based OVS path来允许高级的流缓冲；这只能在选中的path中阻止攻击。强制使用jumbo frames 和TCP buffers会使外来流量受限于缺省MTU且对其他流量无流抵御攻击。 <br>
<strong>MFCGuard:</strong>本文提出当mask数量超过一定阈值时监控和修改MFC，并查找TSE攻击模板10s/次并删除找到的entry。 <br>
移除MFC后该若到来对应的包会则会到slow path查找，然后又会插相同的MFC entry，MFCGuard的作用就是把可疑的entry移到fast path之外，事实上，一量MFC entry被称除它就不会再被插入，这是意料之外的结果，会严重影响性能，但MFC entry可以被重新注入。MFCGuard要求：1.有用流量使用的entry不会被移除；2.要在移除fast path中的entry和slow path的资源之间找到个平衡点，因为如果全都移除了也会影响性能。因此MFCGuard只会移除DROP action的entry。对于第2点要求放入未来工作中，本文注重解决1. <br>
将MFC清空后包都会走slow path，本文测此时包率与CPU使用率，结果如图9c.可见包就绪小于1M时CPU只耗15%大于10000pps时CPU会使用80%(在该率下General TSE已经可以起效果了。)可见本文方法能起到一定的防御效果，因为攻击率超过10000时已经是流量攻击，自然有其他检测方法。</p><div class="md-section-divider"></div><h1 data-anchor-id="nzyz" id="relate-work">Relate Work</h1><p data-anchor-id="k1il">是否虚拟化是当前企业面临的一个复杂问题，因为租户之间交流和共享资源未完美解决，这使得攻击者可协作多个虚拟机来攻击目标虚拟机。当前有针对data plane和C的攻击，也有算法复杂度攻击。本文展示TSS的薄弱处，表明ACL在数据平面会被攻击，而当前的一些防御方法并不是很有并行。本文的MFCGuard与[3]中的不同之处为：本文方法并不需要改原算法。</p></div>
</body>
</html>