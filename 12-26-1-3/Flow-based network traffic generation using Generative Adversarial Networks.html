<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>Flow-based network traffic generation using Generative Adversarial Networks</title>
</head>
<body>
<div style="visibility: hidden; overflow: hidden; position: absolute; top: 0px; height: 1px; width: auto; padding: 0px; border: 0px; margin: 0px; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal;"><div id="MathJax_SVG_Hidden"></div><svg><defs id="MathJax_SVG_glyphs"><path id="MJMAIN-34" stroke-width="1" d="M462 0Q444 3 333 3Q217 3 199 0H190V46H221Q241 46 248 46T265 48T279 53T286 61Q287 63 287 115V165H28V211L179 442Q332 674 334 675Q336 677 355 677H373L379 671V211H471V165H379V114Q379 73 379 66T385 54Q393 47 442 46H471V0H462ZM293 211V545L74 212L183 211H293Z"></path><path id="MJMAIN-32" stroke-width="1" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path><path id="MJMAIN-2217" stroke-width="1" d="M229 286Q216 420 216 436Q216 454 240 464Q241 464 245 464T251 465Q263 464 273 456T283 436Q283 419 277 356T270 286L328 328Q384 369 389 372T399 375Q412 375 423 365T435 338Q435 325 425 315Q420 312 357 282T289 250L355 219L425 184Q434 175 434 161Q434 146 425 136T401 125Q393 125 383 131T328 171L270 213Q283 79 283 63Q283 53 276 44T250 35Q231 35 224 44T216 63Q216 80 222 143T229 213L171 171Q115 130 110 127Q106 124 100 124Q87 124 76 134T64 161Q64 166 64 169T67 175T72 181T81 188T94 195T113 204T138 215T170 230T210 250L74 315Q65 324 65 338Q65 353 74 363T98 374Q106 374 116 368T171 328L229 286Z"></path><path id="MJMATHI-70" stroke-width="1" d="M23 287Q24 290 25 295T30 317T40 348T55 381T75 411T101 433T134 442Q209 442 230 378L240 387Q302 442 358 442Q423 442 460 395T497 281Q497 173 421 82T249 -10Q227 -10 210 -4Q199 1 187 11T168 28L161 36Q160 35 139 -51T118 -138Q118 -144 126 -145T163 -148H188Q194 -155 194 -157T191 -175Q188 -187 185 -190T172 -194Q170 -194 161 -194T127 -193T65 -192Q-5 -192 -24 -194H-32Q-39 -187 -39 -183Q-37 -156 -26 -148H-6Q28 -147 33 -136Q36 -130 94 103T155 350Q156 355 156 364Q156 405 131 405Q109 405 94 377T71 316T59 280Q57 278 43 278H29Q23 284 23 287ZM178 102Q200 26 252 26Q282 26 310 49T356 107Q374 141 392 215T411 325V331Q411 405 350 405Q339 405 328 402T306 393T286 380T269 365T254 350T243 336T235 326L232 322Q232 321 229 308T218 264T204 212Q178 106 178 102Z"></path><path id="MJMATHI-61" stroke-width="1" d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z"></path><path id="MJMATHI-63" stroke-width="1" d="M34 159Q34 268 120 355T306 442Q362 442 394 418T427 355Q427 326 408 306T360 285Q341 285 330 295T319 325T330 359T352 380T366 386H367Q367 388 361 392T340 400T306 404Q276 404 249 390Q228 381 206 359Q162 315 142 235T121 119Q121 73 147 50Q169 26 205 26H209Q321 26 394 111Q403 121 406 121Q410 121 419 112T429 98T420 83T391 55T346 25T282 0T202 -11Q127 -11 81 37T34 159Z"></path><path id="MJMATHI-65" stroke-width="1" d="M39 168Q39 225 58 272T107 350T174 402T244 433T307 442H310Q355 442 388 420T421 355Q421 265 310 237Q261 224 176 223Q139 223 138 221Q138 219 132 186T125 128Q125 81 146 54T209 26T302 45T394 111Q403 121 406 121Q410 121 419 112T429 98T420 82T390 55T344 24T281 -1T205 -11Q126 -11 83 42T39 168ZM373 353Q367 405 305 405Q272 405 244 391T199 357T170 316T154 280T149 261Q149 260 169 260Q282 260 327 284T373 353Z"></path><path id="MJMATHI-74" stroke-width="1" d="M26 385Q19 392 19 395Q19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566T179 586T187 603T197 615T211 624T229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420Q330 398 317 385H210L174 240Q135 80 135 68Q135 26 162 26Q197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145Q322 142 319 133Q314 117 301 95T267 48T216 6T155 -11Q125 -11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383Q128 385 77 385H26Z"></path><path id="MJMATHI-73" stroke-width="1" d="M131 289Q131 321 147 354T203 415T300 442Q362 442 390 415T419 355Q419 323 402 308T364 292Q351 292 340 300T328 326Q328 342 337 354T354 372T367 378Q368 378 368 379Q368 382 361 388T336 399T297 405Q249 405 227 379T204 326Q204 301 223 291T278 274T330 259Q396 230 396 163Q396 135 385 107T352 51T289 7T195 -10Q118 -10 86 19T53 87Q53 126 74 143T118 160Q133 160 146 151T160 120Q160 94 142 76T111 58Q109 57 108 57T107 55Q108 52 115 47T146 34T201 27Q237 27 263 38T301 66T318 97T323 122Q323 150 302 164T254 181T195 196T148 231Q131 256 131 289Z"></path><path id="MJMAIN-2264" stroke-width="1" d="M674 636Q682 636 688 630T694 615T687 601Q686 600 417 472L151 346L399 228Q687 92 691 87Q694 81 694 76Q694 58 676 56H670L382 192Q92 329 90 331Q83 336 83 348Q84 359 96 365Q104 369 382 500T665 634Q669 636 674 636ZM84 -118Q84 -108 99 -98H678Q694 -104 694 -118Q694 -130 679 -138H98Q84 -131 84 -118Z"></path><path id="MJMATHI-62" stroke-width="1" d="M73 647Q73 657 77 670T89 683Q90 683 161 688T234 694Q246 694 246 685T212 542Q204 508 195 472T180 418L176 399Q176 396 182 402Q231 442 283 442Q345 442 383 396T422 280Q422 169 343 79T173 -11Q123 -11 82 27T40 150V159Q40 180 48 217T97 414Q147 611 147 623T109 637Q104 637 101 637H96Q86 637 83 637T76 640T73 647ZM336 325V331Q336 405 275 405Q258 405 240 397T207 376T181 352T163 330L157 322L136 236Q114 150 114 114Q114 66 138 42Q154 26 178 26Q211 26 245 58Q270 81 285 114T318 219Q336 291 336 325Z"></path><path id="MJMATHI-79" stroke-width="1" d="M21 287Q21 301 36 335T84 406T158 442Q199 442 224 419T250 355Q248 336 247 334Q247 331 231 288T198 191T182 105Q182 62 196 45T238 27Q261 27 281 38T312 61T339 94Q339 95 344 114T358 173T377 247Q415 397 419 404Q432 431 462 431Q475 431 483 424T494 412T496 403Q496 390 447 193T391 -23Q363 -106 294 -155T156 -205Q111 -205 77 -183T43 -117Q43 -95 50 -80T69 -58T89 -48T106 -45Q150 -45 150 -87Q150 -107 138 -122T115 -142T102 -147L99 -148Q101 -153 118 -160T152 -167H160Q177 -167 186 -165Q219 -156 247 -127T290 -65T313 -9T321 21L315 17Q309 13 296 6T270 -6Q250 -11 231 -11Q185 -11 150 11T104 82Q103 89 103 113Q103 170 138 262T173 379Q173 380 173 381Q173 390 173 393T169 400T158 404H154Q131 404 112 385T82 344T65 302T57 280Q55 278 41 278H27Q21 284 21 287Z"></path><path id="MJMATHI-6C" stroke-width="1" d="M117 59Q117 26 142 26Q179 26 205 131Q211 151 215 152Q217 153 225 153H229Q238 153 241 153T246 151T248 144Q247 138 245 128T234 90T214 43T183 6T137 -11Q101 -11 70 11T38 85Q38 97 39 102L104 360Q167 615 167 623Q167 626 166 628T162 632T157 634T149 635T141 636T132 637T122 637Q112 637 109 637T101 638T95 641T94 647Q94 649 96 661Q101 680 107 682T179 688Q194 689 213 690T243 693T254 694Q266 694 266 686Q266 675 193 386T118 83Q118 81 118 75T117 65V59Z"></path><path id="MJMAIN-36" stroke-width="1" d="M42 313Q42 476 123 571T303 666Q372 666 402 630T432 550Q432 525 418 510T379 495Q356 495 341 509T326 548Q326 592 373 601Q351 623 311 626Q240 626 194 566Q147 500 147 364L148 360Q153 366 156 373Q197 433 263 433H267Q313 433 348 414Q372 400 396 374T435 317Q456 268 456 210V192Q456 169 451 149Q440 90 387 34T253 -22Q225 -22 199 -14T143 16T92 75T56 172T42 313ZM257 397Q227 397 205 380T171 335T154 278T148 216Q148 133 160 97T198 39Q222 21 251 21Q302 21 329 59Q342 77 347 104T352 209Q352 289 347 316T329 361Q302 397 257 397Z"></path><path id="MJMAIN-35" stroke-width="1" d="M164 157Q164 133 148 117T109 101H102Q148 22 224 22Q294 22 326 82Q345 115 345 210Q345 313 318 349Q292 382 260 382H254Q176 382 136 314Q132 307 129 306T114 304Q97 304 95 310Q93 314 93 485V614Q93 664 98 664Q100 666 102 666Q103 666 123 658T178 642T253 634Q324 634 389 662Q397 666 402 666Q410 666 410 648V635Q328 538 205 538Q174 538 149 544L139 546V374Q158 388 169 396T205 412T256 420Q337 420 393 355T449 201Q449 109 385 44T229 -22Q148 -22 99 32T50 154Q50 178 61 192T84 210T107 214Q132 214 148 197T164 157Z"></path><path id="MJMAIN-2E" stroke-width="1" d="M78 60Q78 84 95 102T138 120Q162 120 180 104T199 61Q199 36 182 18T139 0T96 17T78 60Z"></path><path id="MJMAIN-33" stroke-width="1" d="M127 463Q100 463 85 480T69 524Q69 579 117 622T233 665Q268 665 277 664Q351 652 390 611T430 522Q430 470 396 421T302 350L299 348Q299 347 308 345T337 336T375 315Q457 262 457 175Q457 96 395 37T238 -22Q158 -22 100 21T42 130Q42 158 60 175T105 193Q133 193 151 175T169 130Q169 119 166 110T159 94T148 82T136 74T126 70T118 67L114 66Q165 21 238 21Q293 21 321 74Q338 107 338 175V195Q338 290 274 322Q259 328 213 329L171 330L168 332Q166 335 166 348Q166 366 174 366Q202 366 232 371Q266 376 294 413T322 525V533Q322 590 287 612Q265 626 240 626Q208 626 181 615T143 592T132 580H135Q138 579 143 578T153 573T165 566T175 555T183 540T186 520Q186 498 172 481T127 463Z"></path><path id="MJMATHI-6B" stroke-width="1" d="M121 647Q121 657 125 670T137 683Q138 683 209 688T282 694Q294 694 294 686Q294 679 244 477Q194 279 194 272Q213 282 223 291Q247 309 292 354T362 415Q402 442 438 442Q468 442 485 423T503 369Q503 344 496 327T477 302T456 291T438 288Q418 288 406 299T394 328Q394 353 410 369T442 390L458 393Q446 405 434 405H430Q398 402 367 380T294 316T228 255Q230 254 243 252T267 246T293 238T320 224T342 206T359 180T365 147Q365 130 360 106T354 66Q354 26 381 26Q429 26 459 145Q461 153 479 153H483Q499 153 499 144Q499 139 496 130Q455 -11 378 -11Q333 -11 305 15T277 90Q277 108 280 121T283 145Q283 167 269 183T234 206T200 217T182 220H180Q168 178 159 139T145 81T136 44T129 20T122 7T111 -2Q98 -11 83 -11Q66 -11 57 -1T48 16Q48 26 85 176T158 471L195 616Q196 629 188 632T149 637H144Q134 637 131 637T124 640T121 647Z"></path></defs></svg></div><div id="wmd-preview" class="wmd-preview"><div class="md-section-divider"></div><div class="md-section-divider"></div><h1 data-anchor-id="xiet" id="flow-based-network-traffic-generation-using-generative-adversarial-networks">Flow-based network traffic generation using Generative Adversarial Networks</h1><p data-anchor-id="dj1u"><code>security</code> <br>
Ring M, Schlör D, Landes D, et al. Flow-based network traffic generation using Generative Adversarial Networks[J]. Computers &amp; Security, 2019, 82: 156-172.</p><div class="md-section-divider"></div><h2 data-anchor-id="fugv" id="2020-1-7">2020-1-7</h2><p data-anchor-id="kzna">本文使用GAN来生成网络流量，并提出了三个预处理方法来将流数据中的离散值转成连续值以供GAN来生成，最后评估生成流量的质量。</p><div class="md-section-divider"></div><h1 data-anchor-id="wwdl" id="introduction">Introduction</h1><ul data-anchor-id="mj14">
<li>问题：基于流的数据集流数太多，无法手动标签真实流量，共享会有隐私问题。</li>
<li>Objective: 本文提出的方法：其于已有的网络流量学习其特征来生成可用的网络流量。</li>
<li>Contribution: GAN很善于生成image，本文提出使用GAN生成流量，并提出3个将类别属性转换为持续属性的办法以便于GAN来处理。最后基于CIDDS-001来生成流量。 <br>
下面解释一些基本定义</li>
</ul><div class="md-section-divider"></div><h2 data-anchor-id="14f4" id="flow-based-network-traffic">Flow-based network traffic</h2><p data-anchor-id="ejvm">流：网络包的集合，其有相同的属性，收集流包的时候如果超过一定时间没收到新包则停止收集。表1为无向网络风华正茂属性，网络流的属性种类有持续的，如duration，数据的，如bytes or packets；categorical的，binary的，大多数都是categorial的，如IP，TCP flag可被定义为6个binary或1个categorial类型的。 <br>
<a href="https://imgchr.com/i/lcHPVs" target="_blank"><img src="https://s2.ax1x.com/2020/01/07/lcHPVs.md.png" alt="lcHPVs.md.png"></a></p><div class="md-section-divider"></div><h2 data-anchor-id="hnlu" id="gan">GAN</h2><p data-anchor-id="y28s">区分模型D对生成的数据进行区分，生成模型G生成相似数据。G用噪声向量产生模拟数据并用区分器D的梯度通过反向传播，因此G不会过拟合。生成过程如图1. <br>
<img src="https://s2.ax1x.com/2020/01/07/lcHnr4.png" alt="lcHnr4.png"></p><p data-anchor-id="h6l8">本文使用的GAN模型是《Improved training of wasserstein GAN》。</p><div class="md-section-divider"></div><h2 data-anchor-id="2scv" id="ip2vec">IP2VEC</h2><p data-anchor-id="che1">本方法灵感来自word2Vec,将有相近上下文的IP分到相近的向量空在，详见论文： 《IP2Vec: learning similarities between IP adresses》。如图2所示，191.168.20.1,.2,.3为三个主机，其相似度测量结果sum(.1,.2) &gt; sim(.2,.3)。因为.1,.2有相同的target，使用相同的服务，而.3与他们均不相同。 <br>
<img src="https://s2.ax1x.com/2020/01/07/lcXQCn.png" alt="lcXQCn.png"></p><div class="md-section-divider"></div><h3 data-anchor-id="c2d9" id="ip2vec的model">IP2Vec的Model</h3><p data-anchor-id="fkxc">本文使用的模型简述如图3。 <br>
<a href="https://imgchr.com/i/lcXDv6" target="_blank"><img src="https://s2.ax1x.com/2020/01/07/lcXDv6.md.png" alt="lcXDv6.md.png" title=""></a> <br>
如图所示，全连接，一个隐藏层，将基于流而抽取的特征作为输入，输入格式为特征总数的one-hot向量。例如：训练有100000个不同的IP，200000个不同的PORT和3个不同的PROTO，则one-hot向量的尺寸为120003,每个向量里只有一个维度的值为1,而其他的都为0.输入层与输出层相同，输出层使用softmax，其结果概率表示该vocabulary与输入会在相同上下文的概率。</p><div class="md-section-divider"></div><h3 data-anchor-id="r2dz" id="ip2vec的训练">IP2Vec的训练</h3><p data-anchor-id="dwfg">IP2Vec仅使用sIP,dIP,dPort,proto来训练，表2描述了训练的生成。 <br>
<a href="https://imgchr.com/i/lcvA0S" target="_blank"><img src="https://s2.ax1x.com/2020/01/07/lcvA0S.md.png" alt="lcvA0S.md.png"></a> <br>
每个流生成5个训练样例，如表2的后两列表示了生成的输入与输入。将输入值放入放神经网络，输出现每个vocab会同时在上下文中出现的概率,所有的one-hot的概率加一起为1，但对训练样例来说，其对应vocab的概率为1,其他的vocab都为0.由于参数太多，使用反向传播会耗大量时间，因此本文使用word2vec中的负采样方法，该方法中每个样例只修改部分权重。</p><div class="md-section-divider"></div><h3 data-anchor-id="l9ta" id="continuous-representation-of-ip-addr">continuous representation of IP addr</h3><p data-anchor-id="atwb">训练完后用隐藏层的权重向量来表示IP，即若隐藏层有32个神经元，则每个IP，port,proto都会用32维的连续空间来表示。因为当两个不同的输入IP会有相似的port,proto等输出时，神经网络在隐藏层便会有相近的权重，因此该方法是十分合逻辑的。</p><div class="md-section-divider"></div><h1 data-anchor-id="w0bx" id="transformation-approaches">Transformation approaches</h1><p data-anchor-id="sq8b">本节讲述三种将网络属性转换的办法。对数据处理时，每个数据的不同属性会使用同一种转换方法，本文将timestap转换为两种属性：7个二元表示当天属于周几；用[0,86400]表示当天的第几秒，其值归一化到[0,1]。将proto转换到三个二元属性，TCP flag转换到6个二元属性，具体例子可见表1中的第#3项。</p><div class="md-section-divider"></div><h2 data-anchor-id="fsgm" id="方法1数字化转换">方法1：数字化转换</h2><p data-anchor-id="rtav">对属性进行数据值转换称之为N-WGAN-GP，方法为将所有的十进制数据转到[0,1]，如IP192.168.220.14中的192转换为192/255=0.7529,其他的也作如此转换。对于其他类别的属性也作类似转换，如端口号/65535.表3中提供了将duration,bytes,packets这些属性的3种转换方法的例子。 <br>
<img src="https://s2.ax1x.com/2020/01/08/lg6QBT.png" alt="lg6QBT.png"></p><div class="md-section-divider"></div><h2 data-anchor-id="bgwc" id="方法2二元转换">方法2：二元转换</h2><p data-anchor-id="blgl">为流属性创建数个二元属性，本方法记为G_WGAN-GP.如IP伟转为32位二进制属性。对bytes和packets转换时限制其为32位，对duration则归一化到[0,1].</p><div class="md-section-divider"></div><h2 data-anchor-id="2h5b" id="方法3嵌入转换">方法3：嵌入转换</h2><p data-anchor-id="0ru4">将属性嵌入m维向量中，本方法记为E-WGAN-GP。本文在使用该方法时多用了几个属性，因此每个流会多生成败 个样例，如表4所示，会生成13个样例。本文的INPUT中也有Dip，因为有的IP只在dIP中会出现。E-GAN将充映射为各量后对生成的结果还需要反映射到原始空间，例如：计算当前的sIP的输出与所有的IP之间的Cos相似度，并用最高相似度的IP来替代输出。</p><div class="md-section-divider"></div><h1 data-anchor-id="88r9" id="expriments">Expriments</h1><p data-anchor-id="5jdr">本节对前面提出的三种方法进行评估。</p><div class="md-section-divider"></div><h2 data-anchor-id="kuqx" id="dataset">dataset</h2><p data-anchor-id="yv9p">本文使用无向的基于流的网络流量数据集CDDS-001。图4中有四个子网组成的模拟环境。四个子网分别是：开发者子网dev；办公子网off,其中只有windows主机；管理子网mgt有混合机器；服务器子网。数据集采集了四周的网络流量，本文只在OpenStack中捕获的流量，并将流量区分为两部分：week1,week2-4。前两周流量有攻击流和正常流；后两周流量均为正常流。week2-4有220万流，week1有约85万个流。 <br>
<a href="https://imgchr.com/i/lgjC7D" target="_blank"><img src="https://s2.ax1x.com/2020/01/08/lgjC7D.md.png" alt="lgjC7D.md.png"></a></p><div class="md-section-divider"></div><h2 data-anchor-id="9rud" id="definietion-of-a-baseline">definietion of a baseline</h2><p data-anchor-id="gssj">一个用于比较的方法：生成数据是基于输入数据概率分布的，估计每个属性的概率分布再基于该分布生成新流，生成过程中每个属性独立。</p><div class="md-section-divider"></div><h2 data-anchor-id="eqoe" id="评估方法">评估方法</h2><p data-anchor-id="hi0a">评估GAN的方法有：《Pros and cons of gan evaluation measures》，《 Improved techniques for training GANs》，《Rethinking the inception architecture for computer vision》。对生成流量的评估当前还无共识，本文也列出了一些主要工作，如：《Towards scalable network host simulation》《A comparison of graph-based synthetic data generators for benchmarking next-generation intrusion detection systems》。本文通过计算生成流数据与真实流数据的欧氏距离来评估生成数据的多样性和分布。本文用domain knowledge check来评估一个生成流和内容和流几属性间的关系。</p><div class="md-section-divider"></div><h2 data-anchor-id="jxgo" id="生成数据">生成数据</h2><div class="md-section-divider"></div><h3 data-anchor-id="kwjx" id="参数配置">参数配置</h3><p data-anchor-id="a7a2">用week2-4作为训练数据，并分别用每个生成方法生成85万流数据。对三个GAN网络使用feed-forward神经网络来作为生成器G和区分器D，并使用GANs Trained by a Two Time-Scale Update Rule Converge to a Local Nash Equilibrium中的缺省参数配置，训练和个epoch（更高的训练次数对生成的数据质量影响不大）。通过对不同数量隐藏层神经元进行实验后决定对B-GAN和E-GAN用80个神经元。对N-GAN则24个即可。对E-GAN要先学习IP2Vec向量表示，本文在隐藏层配置20个神经元，并用.IP2Vec: learning similarities between IP adresses中的方法训练10个epoch。</p><div class="md-section-divider"></div><h3 data-anchor-id="2c8x" id="visualization">visualization</h3><p data-anchor-id="7l5h">图5为basweline，E-GAN中生成流量和week1中流量每小时流量占总流量百分比的点线图，可见E-GAN方法更好。 <br>
<img src="https://s2.ax1x.com/2020/01/08/l2PatK.png" alt="l2PatK.png"> <br>
当输入为sIP时，图6和图7分别为PORT和dIP的，每行依次为baseline和三个GAN生成模型。不同的IP有不同的网络行为。 <br>
<a href="https://imgchr.com/i/l2P2AP" target="_blank"><img src="https://s2.ax1x.com/2020/01/08/l2P2AP.md.png" alt="l2P2AP.md.png"></a> <br>
<img src="https://s2.ax1x.com/2020/01/08/l2PWh8.png" alt="l2PWh8.png" title=""> <br>
在图6中可见对于PORT预测，baseline结果并不太好，B-GAN和E-GAN则能很好地做出模拟。在图6和图7中可见N-GAN对属性分布表示不 是十分善长。 <br>
当sIP和dIP同时是外部的则不会被本模块捕捉到，sIP为外部的，dIP为内部的只有少数流，南昌B-GAN和E- <br>
GAN很好地模仿了这部分信息。</p><div class="md-section-divider"></div><h3 data-anchor-id="d51v" id="euclidean-distance">Euclidean distance</h3><p data-anchor-id="6yvl">计算生成数据与输入数据每个属性的芡氏距离，其结果见表5. <br>
<img src="https://s2.ax1x.com/2020/01/08/l2inud.png" alt="l2inud.png"> <br>
由结果可见baseline方法最接近，而B-GAN和E-GAN方法十分接近，N-GAN则略有，或许是因为duration的值过小所致。</p><div class="md-section-divider"></div><h3 data-anchor-id="m4q0" id="domain-knowledge-checks">domain knowledge checks</h3><p data-anchor-id="vti9">本部分提出几个检测生成数据质量的指标。</p><ul data-anchor-id="n84h">
<li>1.如果协议是UDP，则流不会有TCP flag</li>
<li>2.致少一个IP地址是内部的（以192.168.XX.XX开头）。</li>
<li>3.源端口或目的端口为80或443的协议必须是TCP</li>
<li>4.源端口或目的端口为53的协议必须是UDP</li>
<li>5.如果出现多IP或广播IP则必须出现在dIP</li>
<li>6.如果流表示的是netbios信息，则源IP在址须是192.168.XXX.XXX,目的地址须是192.168.XXX.255.</li>
<li>流的packets和bytes必须满足 <span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-61-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -715.9033013280564 16614 942.8066026561128" style="width: 38.556ex; height: 2.222ex; vertical-align: -0.667ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-34"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-32" x="500" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2217" x="1223" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-70" x="1945" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-61" x="2449" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-63" x="2978" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-65" x="3412" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-74" x="3878" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-73" x="4240" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2264" x="4987" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-62" x="6043" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-79" x="6473" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-74" x="6970" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-65" x="7332" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-73" x="7798" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2264" x="8546" y="0"></use><g transform="translate(9602,0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-36"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-35" x="500" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2E" x="1001" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-35" x="1279" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-33" x="1780" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-35" x="2280" y="0"></use></g><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2217" x="12605" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-70" x="13328" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-61" x="13832" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-63" x="14361" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-6B" x="14795" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-65" x="15316" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-74" x="15783" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-73" x="16144" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-61">42*pacets \le bytes \le 65.535* packets</script> <br>
表6为检查符合的比率。 <br>
<a href="https://imgchr.com/i/l2FPMQ" target="_blank"><img src="https://s2.ax1x.com/2020/01/08/l2FPMQ.md.png" alt="l2FPMQ.md.png" title=""></a> <br>
可见baseline效果极差，E-GAN虽然结果好，但其只能生成已有的数据，B-GAN在5,6条效果不好。N-GAN效果最差，可见归一化属性表示根本不合适。</li>
</ul></div>
</body>
</html>