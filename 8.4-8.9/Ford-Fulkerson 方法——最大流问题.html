<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>Ford-Fulkerson 方法——最大流问题</title>
</head>
<body>
<div style="visibility: hidden; overflow: hidden; position: absolute; top: 0px; height: 1px; width: auto; padding: 0px; border: 0px; margin: 0px; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal;"><div id="MathJax_SVG_Hidden"></div><svg><defs id="MathJax_SVG_glyphs"><path id="MJMATHI-63" stroke-width="1" d="M34 159Q34 268 120 355T306 442Q362 442 394 418T427 355Q427 326 408 306T360 285Q341 285 330 295T319 325T330 359T352 380T366 386H367Q367 388 361 392T340 400T306 404Q276 404 249 390Q228 381 206 359Q162 315 142 235T121 119Q121 73 147 50Q169 26 205 26H209Q321 26 394 111Q403 121 406 121Q410 121 419 112T429 98T420 83T391 55T346 25T282 0T202 -11Q127 -11 81 37T34 159Z"></path><path id="MJMATHI-66" stroke-width="1" d="M118 -162Q120 -162 124 -164T135 -167T147 -168Q160 -168 171 -155T187 -126Q197 -99 221 27T267 267T289 382V385H242Q195 385 192 387Q188 390 188 397L195 425Q197 430 203 430T250 431Q298 431 298 432Q298 434 307 482T319 540Q356 705 465 705Q502 703 526 683T550 630Q550 594 529 578T487 561Q443 561 443 603Q443 622 454 636T478 657L487 662Q471 668 457 668Q445 668 434 658T419 630Q412 601 403 552T387 469T380 433Q380 431 435 431Q480 431 487 430T498 424Q499 420 496 407T491 391Q489 386 482 386T428 385H372L349 263Q301 15 282 -47Q255 -132 212 -173Q175 -205 139 -205Q107 -205 81 -186T55 -132Q55 -95 76 -78T118 -61Q162 -61 162 -103Q162 -122 151 -136T127 -157L118 -162Z"></path><path id="MJMAIN-28" stroke-width="1" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path><path id="MJMATHI-75" stroke-width="1" d="M21 287Q21 295 30 318T55 370T99 420T158 442Q204 442 227 417T250 358Q250 340 216 246T182 105Q182 62 196 45T238 27T291 44T328 78L339 95Q341 99 377 247Q407 367 413 387T427 416Q444 431 463 431Q480 431 488 421T496 402L420 84Q419 79 419 68Q419 43 426 35T447 26Q469 29 482 57T512 145Q514 153 532 153Q551 153 551 144Q550 139 549 130T540 98T523 55T498 17T462 -8Q454 -10 438 -10Q372 -10 347 46Q345 45 336 36T318 21T296 6T267 -6T233 -11Q189 -11 155 7Q103 38 103 113Q103 170 138 262T173 379Q173 380 173 381Q173 390 173 393T169 400T158 404H154Q131 404 112 385T82 344T65 302T57 280Q55 278 41 278H27Q21 284 21 287Z"></path><path id="MJMAIN-2C" stroke-width="1" d="M78 35T78 60T94 103T137 121Q165 121 187 96T210 8Q210 -27 201 -60T180 -117T154 -158T130 -185T117 -194Q113 -194 104 -185T95 -172Q95 -168 106 -156T131 -126T157 -76T173 -3V9L172 8Q170 7 167 6T161 3T152 1T140 0Q113 0 96 17Z"></path><path id="MJMATHI-76" stroke-width="1" d="M173 380Q173 405 154 405Q130 405 104 376T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Q21 294 29 316T53 368T97 419T160 441Q202 441 225 417T249 361Q249 344 246 335Q246 329 231 291T200 202T182 113Q182 86 187 69Q200 26 250 26Q287 26 319 60T369 139T398 222T409 277Q409 300 401 317T383 343T365 361T357 383Q357 405 376 424T417 443Q436 443 451 425T467 367Q467 340 455 284T418 159T347 40T241 -11Q177 -11 139 22Q102 54 102 117Q102 148 110 181T151 298Q173 362 173 380Z"></path><path id="MJMAIN-29" stroke-width="1" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path><path id="MJMAIN-3D" stroke-width="1" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path><path id="MJMAIN-7B" stroke-width="1" d="M434 -231Q434 -244 428 -250H410Q281 -250 230 -184Q225 -177 222 -172T217 -161T213 -148T211 -133T210 -111T209 -84T209 -47T209 0Q209 21 209 53Q208 142 204 153Q203 154 203 155Q189 191 153 211T82 231Q71 231 68 234T65 250T68 266T82 269Q116 269 152 289T203 345Q208 356 208 377T209 529V579Q209 634 215 656T244 698Q270 724 324 740Q361 748 377 749Q379 749 390 749T408 750H428Q434 744 434 732Q434 719 431 716Q429 713 415 713Q362 710 332 689T296 647Q291 634 291 499V417Q291 370 288 353T271 314Q240 271 184 255L170 250L184 245Q202 239 220 230T262 196T290 137Q291 131 291 1Q291 -134 296 -147Q306 -174 339 -192T415 -213Q429 -213 431 -216Q434 -219 434 -231Z"></path><path id="MJMAIN-2212" stroke-width="1" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z"></path><path id="MJMAIN-20" stroke-width="1"></path><path id="MJMAIN-69" stroke-width="1" d="M69 609Q69 637 87 653T131 669Q154 667 171 652T188 609Q188 579 171 564T129 549Q104 549 87 564T69 609ZM247 0Q232 3 143 3Q132 3 106 3T56 1L34 0H26V46H42Q70 46 91 49Q100 53 102 60T104 102V205V293Q104 345 102 359T88 378Q74 385 41 385H30V408Q30 431 32 431L42 432Q52 433 70 434T106 436Q123 437 142 438T171 441T182 442H185V62Q190 52 197 50T232 46H255V0H247Z"></path><path id="MJMAIN-66" stroke-width="1" d="M273 0Q255 3 146 3Q43 3 34 0H26V46H42Q70 46 91 49Q99 52 103 60Q104 62 104 224V385H33V431H104V497L105 564L107 574Q126 639 171 668T266 704Q267 704 275 704T289 705Q330 702 351 679T372 627Q372 604 358 590T321 576T284 590T270 627Q270 647 288 667H284Q280 668 273 668Q245 668 223 647T189 592Q183 572 182 497V431H293V385H185V225Q185 63 186 61T189 57T194 54T199 51T206 49T213 48T222 47T231 47T241 46T251 46H282V0H273Z"></path><path id="MJMAIN-2208" stroke-width="1" d="M84 250Q84 372 166 450T360 539Q361 539 377 539T419 540T469 540H568Q583 532 583 520Q583 511 570 501L466 500Q355 499 329 494Q280 482 242 458T183 409T147 354T129 306T124 272V270H568Q583 262 583 250T568 230H124V228Q124 207 134 177T167 112T231 48T328 7Q355 1 466 0H570Q583 -10 583 -20Q583 -32 568 -40H471Q464 -40 446 -40T417 -41Q262 -41 172 45Q84 127 84 250Z"></path><path id="MJMATHI-45" stroke-width="1" d="M492 213Q472 213 472 226Q472 230 477 250T482 285Q482 316 461 323T364 330H312Q311 328 277 192T243 52Q243 48 254 48T334 46Q428 46 458 48T518 61Q567 77 599 117T670 248Q680 270 683 272Q690 274 698 274Q718 274 718 261Q613 7 608 2Q605 0 322 0H133Q31 0 31 11Q31 13 34 25Q38 41 42 43T65 46Q92 46 125 49Q139 52 144 61Q146 66 215 342T285 622Q285 629 281 629Q273 632 228 634H197Q191 640 191 642T193 659Q197 676 203 680H757Q764 676 764 669Q764 664 751 557T737 447Q735 440 717 440H705Q698 445 698 453L701 476Q704 500 704 528Q704 558 697 578T678 609T643 625T596 632T532 634H485Q397 633 392 631Q388 629 386 622Q385 619 355 499T324 377Q347 376 372 376H398Q464 376 489 391T534 472Q538 488 540 490T557 493Q562 493 565 493T570 492T572 491T574 487T577 483L544 351Q511 218 508 216Q505 213 492 213Z"></path><path id="MJMAIN-30" stroke-width="1" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z"></path><path id="MJMAIN-6F" stroke-width="1" d="M28 214Q28 309 93 378T250 448Q340 448 405 380T471 215Q471 120 407 55T250 -10Q153 -10 91 57T28 214ZM250 30Q372 30 372 193V225V250Q372 272 371 288T364 326T348 362T317 390T268 410Q263 411 252 411Q222 411 195 399Q152 377 139 338T126 246V226Q126 130 145 91Q177 30 250 30Z"></path><path id="MJMAIN-74" stroke-width="1" d="M27 422Q80 426 109 478T141 600V615H181V431H316V385H181V241Q182 116 182 100T189 68Q203 29 238 29Q282 29 292 100Q293 108 293 146V181H333V146V134Q333 57 291 17Q264 -10 221 -10Q187 -10 162 2T124 33T105 68T98 100Q97 107 97 248V385H18V422H27Z"></path><path id="MJMAIN-68" stroke-width="1" d="M41 46H55Q94 46 102 60V68Q102 77 102 91T102 124T102 167T103 217T103 272T103 329Q103 366 103 407T103 482T102 542T102 586T102 603Q99 622 88 628T43 637H25V660Q25 683 27 683L37 684Q47 685 66 686T103 688Q120 689 140 690T170 693T181 694H184V367Q244 442 328 442Q451 442 463 329Q464 322 464 190V104Q464 66 466 59T477 49Q498 46 526 46H542V0H534L510 1Q487 2 460 2T422 3Q319 3 310 0H302V46H318Q379 46 379 62Q380 64 380 200Q379 335 378 343Q372 371 358 385T334 402T308 404Q263 404 229 370Q202 343 195 315T187 232V168V108Q187 78 188 68T191 55T200 49Q221 46 249 46H265V0H257L234 1Q210 2 183 2T145 3Q42 3 33 0H25V46H41Z"></path><path id="MJMAIN-65" stroke-width="1" d="M28 218Q28 273 48 318T98 391T163 433T229 448Q282 448 320 430T378 380T406 316T415 245Q415 238 408 231H126V216Q126 68 226 36Q246 30 270 30Q312 30 342 62Q359 79 369 104L379 128Q382 131 395 131H398Q415 131 415 121Q415 117 412 108Q393 53 349 21T250 -11Q155 -11 92 58T28 218ZM333 275Q322 403 238 411H236Q228 411 220 410T195 402T166 381T143 340T127 274V267H333V275Z"></path><path id="MJMAIN-72" stroke-width="1" d="M36 46H50Q89 46 97 60V68Q97 77 97 91T98 122T98 161T98 203Q98 234 98 269T98 328L97 351Q94 370 83 376T38 385H20V408Q20 431 22 431L32 432Q42 433 60 434T96 436Q112 437 131 438T160 441T171 442H174V373Q213 441 271 441H277Q322 441 343 419T364 373Q364 352 351 337T313 322Q288 322 276 338T263 372Q263 381 265 388T270 400T273 405Q271 407 250 401Q234 393 226 386Q179 341 179 207V154Q179 141 179 127T179 101T180 81T180 66V61Q181 59 183 57T188 54T193 51T200 49T207 48T216 47T225 47T235 46T245 46H276V0H267Q249 3 140 3Q37 3 28 0H20V46H36Z"></path><path id="MJMAIN-77" stroke-width="1" d="M90 368Q84 378 76 380T40 385H18V431H24L43 430Q62 430 84 429T116 428Q206 428 221 431H229V385H215Q177 383 177 368Q177 367 221 239L265 113L339 328L333 345Q323 374 316 379Q308 384 278 385H258V431H264Q270 428 348 428Q439 428 454 431H461V385H452Q404 385 404 369Q404 366 418 324T449 234T481 143L496 100L537 219Q579 341 579 347Q579 363 564 373T530 385H522V431H529Q541 428 624 428Q692 428 698 431H703V385H697Q696 385 691 385T682 384Q635 377 619 334L559 161Q546 124 528 71Q508 12 503 1T487 -11H479Q460 -11 456 -4Q455 -3 407 133L361 267Q359 263 266 -4Q261 -11 243 -11H238Q225 -11 220 -3L90 368Z"></path><path id="MJMAIN-73" stroke-width="1" d="M295 316Q295 356 268 385T190 414Q154 414 128 401Q98 382 98 349Q97 344 98 336T114 312T157 287Q175 282 201 278T245 269T277 256Q294 248 310 236T342 195T359 133Q359 71 321 31T198 -10H190Q138 -10 94 26L86 19L77 10Q71 4 65 -1L54 -11H46H42Q39 -11 33 -5V74V132Q33 153 35 157T45 162H54Q66 162 70 158T75 146T82 119T101 77Q136 26 198 26Q295 26 295 104Q295 133 277 151Q257 175 194 187T111 210Q75 227 54 256T33 318Q33 357 50 384T93 424T143 442T187 447H198Q238 447 268 432L283 424L292 431Q302 440 314 448H322H326Q329 448 335 442V310L329 304H301Q295 310 295 316Z"></path><path id="MJSZ4-23A7" stroke-width="1" d="M712 899L718 893V876V865Q718 854 704 846Q627 793 577 710T510 525Q510 524 509 521Q505 493 504 349Q504 345 504 334Q504 277 504 240Q504 -2 503 -4Q502 -8 494 -9T444 -10Q392 -10 390 -9Q387 -8 386 -5Q384 5 384 230Q384 262 384 312T383 382Q383 481 392 535T434 656Q510 806 664 892L677 899H712Z"></path><path id="MJSZ4-23A9" stroke-width="1" d="M718 -893L712 -899H677L666 -893Q542 -825 468 -714T385 -476Q384 -466 384 -282Q384 3 385 5L389 9Q392 10 444 10Q486 10 494 9T503 4Q504 2 504 -239V-310V-366Q504 -470 508 -513T530 -609Q546 -657 569 -698T617 -767T661 -812T699 -843T717 -856T718 -876V-893Z"></path><path id="MJSZ4-23A8" stroke-width="1" d="M389 1159Q391 1160 455 1160Q496 1160 498 1159Q501 1158 502 1155Q504 1145 504 924Q504 691 503 682Q494 549 425 439T243 259L229 250L243 241Q349 175 421 66T503 -182Q504 -191 504 -424Q504 -600 504 -629T499 -659H498Q496 -660 444 -660T390 -659Q387 -658 386 -655Q384 -645 384 -425V-282Q384 -176 377 -116T342 10Q325 54 301 92T255 155T214 196T183 222T171 232Q170 233 170 250T171 268Q171 269 191 284T240 331T300 407T354 524T383 679Q384 691 384 925Q384 1152 385 1155L389 1159Z"></path><path id="MJSZ4-23AA" stroke-width="1" d="M384 150V266Q384 304 389 309Q391 310 455 310Q496 310 498 309Q502 308 503 298Q504 283 504 150Q504 32 504 12T499 -9H498Q496 -10 444 -10T390 -9Q386 -8 385 2Q384 17 384 150Z"></path><path id="MJMAIN-2032" stroke-width="1" d="M79 43Q73 43 52 49T30 61Q30 68 85 293T146 528Q161 560 198 560Q218 560 240 545T262 501Q262 496 260 486Q259 479 173 263T84 45T79 43Z"></path><path id="MJMAIN-2B" stroke-width="1" d="M56 237T56 250T70 270H369V420L370 570Q380 583 389 583Q402 583 409 568V270H707Q722 262 722 250T707 230H409V-68Q401 -82 391 -82H389H387Q375 -82 369 -68V230H70Q56 237 56 250Z"></path><path id="MJMATHI-46" stroke-width="1" d="M48 1Q31 1 31 11Q31 13 34 25Q38 41 42 43T65 46Q92 46 125 49Q139 52 144 61Q146 66 215 342T285 622Q285 629 281 629Q273 632 228 634H197Q191 640 191 642T193 659Q197 676 203 680H742Q749 676 749 669Q749 664 736 557T722 447Q720 440 702 440H690Q683 445 683 453Q683 454 686 477T689 530Q689 560 682 579T663 610T626 626T575 633T503 634H480Q398 633 393 631Q388 629 386 623Q385 622 352 492L320 363H375Q378 363 398 363T426 364T448 367T472 374T489 386Q502 398 511 419T524 457T529 475Q532 480 548 480H560Q567 475 567 470Q567 467 536 339T502 207Q500 200 482 200H470Q463 206 463 212Q463 215 468 234T473 274Q473 303 453 310T364 317H309L277 190Q245 66 245 60Q245 46 334 46H359Q365 40 365 39T363 19Q359 6 353 0H336Q295 2 185 2Q120 2 86 2T48 1Z"></path><path id="MJMAIN-6E" stroke-width="1" d="M41 46H55Q94 46 102 60V68Q102 77 102 91T102 122T103 161T103 203Q103 234 103 269T102 328V351Q99 370 88 376T43 385H25V408Q25 431 27 431L37 432Q47 433 65 434T102 436Q119 437 138 438T167 441T178 442H181V402Q181 364 182 364T187 369T199 384T218 402T247 421T285 437Q305 442 336 442Q450 438 463 329Q464 322 464 190V104Q464 66 466 59T477 49Q498 46 526 46H542V0H534L510 1Q487 2 460 2T422 3Q319 3 310 0H302V46H318Q379 46 379 62Q380 64 380 200Q379 335 378 343Q372 371 358 385T334 402T308 404Q263 404 229 370Q202 343 195 315T187 232V168V108Q187 78 188 68T191 55T200 49Q221 46 249 46H265V0H257L234 1Q210 2 183 2T145 3Q42 3 33 0H25V46H41Z"></path><path id="MJMATHI-50" stroke-width="1" d="M287 628Q287 635 230 637Q206 637 199 638T192 648Q192 649 194 659Q200 679 203 681T397 683Q587 682 600 680Q664 669 707 631T751 530Q751 453 685 389Q616 321 507 303Q500 302 402 301H307L277 182Q247 66 247 59Q247 55 248 54T255 50T272 48T305 46H336Q342 37 342 35Q342 19 335 5Q330 0 319 0Q316 0 282 1T182 2Q120 2 87 2T51 1Q33 1 33 11Q33 13 36 25Q40 41 44 43T67 46Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628ZM645 554Q645 567 643 575T634 597T609 619T560 635Q553 636 480 637Q463 637 445 637T416 636T404 636Q391 635 386 627Q384 621 367 550T332 412T314 344Q314 342 395 342H407H430Q542 342 590 392Q617 419 631 471T645 554Z"></path></defs></svg></div><div id="wmd-preview" class="wmd-preview"><div class="md-section-divider"></div><div class="md-section-divider"></div><h1 data-anchor-id="65kp" id="ford-fulkerson-方法最大流问题">Ford-Fulkerson 方法——最大流问题</h1><p data-anchor-id="poui"><code>algorithm</code></p><hr><p data-anchor-id="bokn">本算法的目的是计算一个网络中的最大流问题；</p><div class="md-section-divider"></div><h1 data-anchor-id="jkvh" id="基本知识">基本知识</h1><div class="md-section-divider"></div><h2 data-anchor-id="pr27" id="背景">背景</h2><ul data-anchor-id="wm6b">
<li>我们有图 G=(V, E)，V是顶点的集合，E是边的集合。</li>
<li>图中边的权重都为非负数 （满足1，2两点有时称之为流网络）。</li>
<li>对于这个图G，有两个顶点很重要，一个是源头s，一个是汇聚点t，我们想考虑的是从源头s流向汇聚点t的流。 <br>
<strong>我们想要解决的问题：</strong>在一个流里，有着每条边的运载能力限制，我最多能从源头运输多少数量到目的地。</li>
</ul><div class="md-section-divider"></div><h2 data-anchor-id="6pzz" id="流的定义">流的定义</h2><p data-anchor-id="u98v">从源头s运送到汇聚点t的东西，比如下水道系统运输水流，公路网络运输车流 <br>
流的特点：</p><ul data-anchor-id="c2a2">
<li>对于图中非s和t的普通结点，流进量等于流出量</li>
<li>我们非常关心总运输流量，比如这个下水道系统，究竟从s点到t点最多能运输多少立方米的水？我们把它记成|f|，这个|f|极其重要，是我们研究的目的所在。</li>
<li>当然，每条边是有运输上限的，就像某条公路车流是有上限的一样，若运输量无穷无尽，我们的研究也就没有意义了。我们将从u点到v点的运输上限，或者说是运载能力记为c(u,v)。对于从u点到v点的流量，记作f(u,v)。显然对所有边(u,v)我们有f(u,v)&lt;=c(u,v)。 <br>
<strong>研究目的</strong>：最大化|f| (|f|的定义在上面第二点)，在一个流网络里，有着每条边的运载能力限制，我最多能从s运输多少东西到t。</li>
</ul><p data-anchor-id="3zjy">总结一下，流可以看成一个图，满足两个条件： <br>
1. 除了s和t，流入等于流出。 <br>
2. 所有边的流量f小于运载量c。(flow &lt; capacity) <br>
让我们来看一个流的例子： <br>
<img src="https://s2.ax1x.com/2019/08/08/eTwzYn.png" alt="eTwzYn.png"> <br>
此图中除了s和t，流入等于流出，每条边的流量小于运载上限(比如10/20，10是流量，20是上限)。</p><p data-anchor-id="cqf7">那么这个图中我们关心的总运输量是多少呢？</p><p data-anchor-id="eafb">是10！直观来想，从s流出10的流量，在复杂网络中经过一系列流入等于流出的操作，最终汇入t，这就是总流量的定义：从s运输到t的流量数。</p><p data-anchor-id="it62">所以提及总流量，我们盯着s看就好了。</p><p data-anchor-id="kyp7">回忆起我们的研究目的，其实就是想寻找一个最大的|f|，此例中|f|=10，还能更大吗？</p><p data-anchor-id="2nuc">这就是最大流问题：寻找满足运载上限的最大流。 <br>
为了解决这个问题，我们引进割，那么割是什么呢？</p><div class="md-section-divider"></div><h2 data-anchor-id="v0gc" id="割的定义">割的定义</h2><p data-anchor-id="0e86">割说白了，就是对于点的分割，有了流的基础，我们直接看例子。 <br>
<img src="https://s2.ax1x.com/2019/08/08/eTDnsK.png" alt="eTDnsK.png" title=""> <br>
左右两个黄色的区域，说白了就是点的集合，正式一点来说，我们把它记成(S,S’)，比如左黄区域为S(源头s在S里)，右黄区域为S’(目的地t在S’里)。 <br>
割很随意，但是有个要求，就是s和t要属于不同的区域！</p><p data-anchor-id="neqe">对于割，我们只关心一个事情：从S到S’的总运载上限cap(S,S’)，就是割的容量。比如这个例子里，cap(S,S’)=5+10=15，而不是等于5+10+15=30。</p><p data-anchor-id="c85w">这个定义还挺死板的，总结一下，割形成了两个区域，我们关心的是两个区域之间“桥梁”的运载量之和，桥梁的方向一定是一致的，比如都是从S到S’的方向。</p><p data-anchor-id="v17q">在我们知道了所有割的容量后，我们最想知道的是这其中最小的那个容量，即最小割的容量。</p><p data-anchor-id="j3lt">说完了割，还是没有说到为什么这个概念的引进可以解决最大流问题，我们接下来看看最大流最小割的关系。</p><div class="md-section-divider"></div><h2 data-anchor-id="6fra" id="最大流最小割">最大流最小割</h2><p data-anchor-id="4dl9">我们回忆一下，流是一个边权重非负的图，流入等于流出。割是把流分成两个区域，s和t分布于不同的区域。</p><p data-anchor-id="5qtc">最小割大于等于最大流，因为只有这样，流才能顺利从一个区域运输到另一个区域（想想流要通过从S到S’的桥梁）。</p><p data-anchor-id="j6ag">换言之，对于任意一个割(S,S’)，最大流都要小于等于cap(S,S’)，因为我研究的是从源头s到t，可以想成是从S区域到S’区域，那么我运输的流量肯定要小于等于桥梁的总限制。</p><p data-anchor-id="nike">所以我们有了第一个关系式：max|f| &lt;= cap(S,S’)</p><p data-anchor-id="4xhj">关键的来了，这个关系式的上界取等发生在(S,S’)是最小割。这个被称为最大流最小割定理，所以我们完成了转化，将寻找最大流问题转化为了寻找最小割的问题。</p><p data-anchor-id="kryt">那么如何找到最小割呢？ <br>
首先引进两个术语：saturate和avoid，这两个词都是形容流f对边e)的。还是很形象的，一个充满一个避开。 <br>
f saturates e: 即f(e) = c(e)，就是流量充满了运载上限，比如10/10。 <br>
f avoids e: f(e) = 0 <br>
有这两个术语后，我们有方法如下： <br>
f是一个流，(S, S’)是一个割，如果f充满了从S到S’的每一座桥，避开了从S’到S的每一座桥，则f是一个最大流，(S, S’)是一个最小割。 <br>
那么为什么最大流等于最小割的总运载上限呢？（本处不计论） <br>
先不考虑为什么，我们先介绍如何找到最大流的算法，即Ford-Fulkerson算法。</p><div class="md-section-divider"></div><h2 data-anchor-id="w2ou" id="ford-fulkerson">Ford-Fulkerson</h2><p data-anchor-id="9m72">首先这个算法有个重要的工具：残存网络。残存网络其实就是具有残存容量的图。算法导论上有个普遍公式来定义残存容量： <br>
<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-3-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -2145.4033013280564 18873.807029269374 3790.806602656113" style="width: 43.889ex; height: 8.778ex; vertical-align: -3.889ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-63"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-66" x="613" y="-219"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-28" x="922" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-75" x="1312" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2C" x="1884" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-76" x="2329" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-29" x="2815" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-3D" x="3482" y="0"></use><g transform="translate(4538,0)"><g transform="translate(0,2124)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJSZ4-23A7" x="0" y="-900"></use><g transform="translate(0,-1008.2903726708075) scale(1,0.47360248447204967)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJSZ4-23AA"></use></g><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJSZ4-23A8" x="0" y="-2125"></use><g transform="translate(0,-2882.7903726708073) scale(1,0.47360248447204967)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJSZ4-23AA"></use></g><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJSZ4-23A9" x="0" y="-2849"></use></g><g transform="translate(1056,0)"><g transform="translate(-16,0)"><g transform="translate(0,1324)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-63"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-28" x="433" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-75" x="823" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2C" x="1395" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-76" x="1840" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-29" x="2326" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2212" x="2937" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-66" x="3938" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-28" x="4489" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-75" x="4878" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2C" x="5451" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-76" x="5896" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-29" x="6381" y="0"></use></g><g transform="translate(0,-78)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-66"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-28" x="550" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-76" x="940" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2C" x="1425" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-75" x="1870" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-29" x="2443" y="0"></use></g><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-30" x="0" y="-1425"></use></g><g transform="translate(7755,0)"><g transform="translate(0,1324)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-20"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-69" x="250" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-66" x="529" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-20" x="835" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-28" x="1086" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-75" x="1475" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2C" x="2048" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-76" x="2493" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-29" x="2978" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2208" x="3645" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-45" x="4591" y="0"></use></g><g transform="translate(0,-78)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-20"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-69" x="250" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-66" x="529" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-20" x="835" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-28" x="1086" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-76" x="1475" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2C" x="1961" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-75" x="2406" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-29" x="2978" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2208" x="3645" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-45" x="4591" y="0"></use></g><g transform="translate(0,-1425)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-20"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-6F" x="250" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-74" x="751" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-68" x="1140" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-65" x="1697" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-72" x="2141" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-77" x="2534" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-69" x="3256" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-73" x="3535" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-65" x="3929" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-20" x="4374" y="0"></use></g></g></g></g></g></svg></span><script type="math/tex" id="MathJax-Element-3">c_{f}(u, v)=\left\{\begin{array}{ll}{c(u, v)-f(u, v)} & {\text { if }(u, v) \in E} \\ {f(v, u)} & {\text { if }(v, u) \in E} \\ {0} & {\text { otherwise }}\end{array}\right.</script> <br>
翻译一下公式，说明的就是对于两点间的残存容量定义为： <br>
1.如果这两点连线原来就是原图的边，那么它的残存容量等于运载上限-运输流量。 <br>
2.如果这两点的反向连线是原图的边，那么它的残存容量等于那条边的运输流量。 <br>
3.其他情况是0，当做没连通。</p><p data-anchor-id="f1wq">很不直观呀，所以我们结合例子来说明说明残存容量以及残存网络。 <br>
首先先明确一下，在残存网络中我们只关心运载上限（就是残存容量啦）。 <br>
<img src="https://s2.ax1x.com/2019/08/08/eTgtQs.png" alt="eTgtQs.png"> <br>
这个例子中，左边是原图，右边是残存网络。 <br>
我们先来看源头s和它右上角的结点a（就是10/20相连的那两点），为什么转换成残存网络中形成了一个10和10的圈？ <br>
我们回到不直观的公式定义，cf(s,a)应该是等于20-10的，因为(s,a)是原图的边。那么cf(a,s)是多少呢，因为这个的反向连线在原图里是(s,a)是边，所以cf(a,s) = f(s,a) = 10 <br>
那么直观来说怎么生成残存网络呢，原图的每条边都需要拆解，比如考虑那条5/15的从b指向t的边，我们画在残存网络中就是生成一条15-5容量的边，从b指向t，然后生成一个5的边，从t指向b。（不用为b是哪个点感到困惑，其实就是例子中t左上角的那个点）如果发现容量为0的边，就不用画在残存网络里了。</p><p data-anchor-id="coi4">接下来我们看看残存网络对我们的帮助： <br>
1.残存网络中没有从s到t的路径时，最大流等于最小割容量。 <br>
2.残存网络中有从s到t的路径时，最大流不等于最小割容量。 <br>
如果是情况2：我们考虑路径P：s-&gt;v0-&gt;v1-&gt;v2-&gt;… -&gt;vn -&gt;t，把它叫<strong>增广路径</strong>。在增广路径中找最小的cf，记作F。在这种残存网络还有路径从s通向t的情况中，<strong>我们没有做到最好</strong>，我们要把F纳入我们对于流的更新，直到找不到增广路径为止，更新方法如下： <br>
<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-11-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -2198.4033013280564 16948.18044222085 3896.806602656113" style="width: 39.333ex; height: 9ex; vertical-align: -4ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-66"></use><use transform="scale(0.7071067811865476)" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2032" x="804" y="513"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-28" x="863" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-75" x="1252" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2C" x="1825" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-76" x="2270" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-29" x="2756" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-3D" x="3423" y="0"></use><g transform="translate(4479,0)"><g transform="translate(0,2177)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJSZ4-23A7" x="0" y="-900"></use><g transform="translate(0,-1059.4798136645963) scale(1,0.6381987577639752)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJSZ4-23AA"></use></g><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJSZ4-23A8" x="0" y="-2178"></use><g transform="translate(0,-2986.9798136645963) scale(1,0.6381987577639752)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJSZ4-23AA"></use></g><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJSZ4-23A9" x="0" y="-2955"></use></g><g transform="translate(1056,0)"><g transform="translate(-16,0)"><g transform="translate(0,1377)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-66"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-28" x="550" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-75" x="940" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2C" x="1512" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-76" x="1957" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-29" x="2443" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2B" x="3054" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-46" x="4055" y="0"></use></g><g transform="translate(0,-25)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-66"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-28" x="550" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-75" x="940" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2C" x="1512" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-76" x="1957" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-29" x="2443" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2212" x="3054" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-46" x="4055" y="0"></use></g><g transform="translate(0,-1427)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-66"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-28" x="550" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-75" x="940" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2C" x="1512" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-76" x="1957" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-29" x="2443" y="0"></use></g></g><g transform="translate(5789,0)"><g transform="translate(0,1377)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-20"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-69" x="250" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-66" x="529" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-20" x="835" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-28" x="1086" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-75" x="1475" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2C" x="2048" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-76" x="2493" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-29" x="2978" y="0"></use><g transform="translate(3368,0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-20"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-69" x="250" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-6E" x="529" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-20" x="1085" y="0"></use></g><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-50" x="4704" y="0"></use></g><g transform="translate(0,-25)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-20"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-69" x="250" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-66" x="529" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-20" x="835" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-28" x="1086" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-76" x="1475" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-2C" x="1961" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-75" x="2406" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-29" x="2978" y="0"></use><g transform="translate(3368,0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-20"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-69" x="250" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-6E" x="529" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-20" x="1085" y="0"></use></g><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMATHI-50" x="4704" y="0"></use></g><g transform="translate(0,-1427)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-20"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-6F" x="250" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-74" x="751" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-68" x="1140" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-65" x="1697" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-72" x="2141" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-77" x="2534" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-69" x="3256" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-73" x="3535" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-65" x="3929" y="0"></use><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#MJMAIN-20" x="4374" y="0"></use></g></g></g></g></g></svg></span><script type="math/tex" id="MathJax-Element-11">f^{\prime}(u, v)=\left\{\begin{array}{ll}{f(u, v)+F} & {\text { if }(u, v) \text { in } P} \\ {f(u, v)-F} & {\text { if }(v, u) \text { in } P} \\ {f(u, v)} & {\text { otherwise }}\end{array}\right.</script> <br>
做了这么多铺垫，又是残存网络，又是对流的更新，接下来介绍Ford-Fulkerson算法。 <br>
我们从0流量出发（此时残存网络就是原图），找到增广路径（注意增广路径一定是在残存网络里找），接着把流更新，直到残存网络中没有增广路径（就是没有路径从s到t啦）为止。下面我们还是看例子： <br>
<img src="https://s2.ax1x.com/2019/08/08/eTo2XF.png" alt="eTo2XF.png"> <br>
在示例中，左边是残存网络，右边是更新后的原图。一开始(a)的残存网络就是原图，我们找了条增广路径（粗线），找到了最小的cf，就是4，然后把4引入了原图的流更新。 <br>
从(a)更新后的原图，我们可以画出它的残存网络，于是我们来到了(b)，还是老步骤，找增广路径，找最小的cf，以它来更新原图（从(a)的右图到(b)的右图）。强烈推荐从c往后自己将这个过程找完，花几分钟找完你就记住了Ford-Fulkerson算法。答案如下，增广路径选取不同，过程可能不一样，但是最大流都是一样的，就是23： <br>
<img src="https://s2.ax1x.com/2019/08/08/eTbYNj.png" alt="eTbYNj.png"> <br>
在(f)中，我们再也无法找到增广路径，所以我们的算法结束，这是我们的最大流。</p><p data-anchor-id="y6as">总结一下，我们要解决的问题是在一个有运载限制的网络系统中，从s到t最多能运输多少流量。我们引进了流，割的概念，将我们研究的问题转化为寻找最大流。 <br>
如何找最大流？采用Ford-Fulkerson算法，从0流量开始，生成残存网络，找到增广路径，从增广路径中找到最小的残存容量F，用F来更新原图，得到新的原图后，循环上述过程直到残存网络中找不到增广路径。此时的原图中，就有了我们想求的最大流。 <br>
那么我们引进割是为什么呢，是为了证明Ford-Fulkerson算法的正确性。这个可以开一篇新的文章来说，想要理解Ford-Fulkerson的运行过程看这篇文章就够了，如果想知道为什么Ford-Fulkerson可以找到最大流，可以单独查一下。</p><p data-anchor-id="mozf">参考自<a href="https://blog.csdn.net/sinat_41613352/article/details/84481115" target="_blank">这里</a></p><p data-anchor-id="k7l7"><strong>虽然这个路子会走，但是真的不知道为什么可行。</strong></p><p data-anchor-id="87bz">另一个博客，对反向边的原理解释，这也是我疑惑的地方，他解释地不错，参考自<a href="https://www.jianshu.com/p/efb2d79e2b0f" target="_blank">这里</a></p><ul data-anchor-id="y7z2">
<li>如果没有反向边，那么对于： <br>
<img src="https://s2.ax1x.com/2019/08/08/eTXLTS.png" alt="eTXLTS.png"> <br>
我们第一次找到了 1-2-3-4 这条增广路，这条路上的最小边剩余流量显然是 1。于是我们修改后得到了下面这个残留网络： <br>
<img src="https://s2.ax1x.com/2019/08/08/eTjAkF.png" alt="eTjAkF.png"> <br>
这时候 (1,2) 和 (3,4) 边上的流量都等于容量了，我们再也找不到其他的增广路了，当前的流量是 1。但这个答案明显不是最大流，因为我们可以同时走 1-2-4 和 1-3-4，这样可以得到流量为 2 的流。 <br>
而这个算法神奇的利用了一个叫做反向边的概念来解决这个问题。即每条边 (I,j) 都有一条反向边 (j,i)，反向边也同样有它的容量。那么我们刚刚的算法问题在哪里呢？问题就在于我们没有给程序一个” 后悔” 的机会，应该有一个不走 (2-3-4) 而改走 (2-4) 的机制。</li>
<li>我们来看刚才的例子，在找到 1-2-3-4 这条增广路之后，把容量修改成如下: <br>
<img src="https://s2.ax1x.com/2019/08/08/eTjWn0.png" alt="eTjWn0.png"> <br>
这时再找增广路的时候，就会找到 1-3-2-4 这条可增广量，即 delta 值为 1 的可增广路。将这条路增广之后，得到了最大流 2。 <br>
<img src="https://s2.ax1x.com/2019/08/08/eTjH39.png" alt="eTjH39.png"></li>
<li>解释： <br>
事实上，当我们第二次的增广路走 3-2 这条反向边的时候，就相当于把 2-3 这条正向边已经是用了的流量给” 退” 了回去，不走 2-3 这条路，而改走从 2 点出发的其他的路也就是 2-4。（有人问如果这里没有 2-4 怎么办，这时假如没有 2-4 这条路的话，最终这条增广路也不会存在，因为他根本不能走到汇点）同时本来在 3-4 上的流量由 1-3-4 这条路来” 接管”。而最终 2-3 这条路正向流量 1，反向流量 1，等于没有流量。 <br>
这就是这个算法的精华部分，利用反向边，使程序有了一个后悔和改正的机会。</li>
</ul><p data-anchor-id="4bew">贴上一个别人的源码：</p><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="vaah"><ol class="linenums"><li class="L0"><code class="language-python"><span class="kwd">import</span><span class="pln"> copy</span></code></li><li class="L1"><code class="language-python"><span class="kwd">from</span><span class="pln"> collections </span><span class="kwd">import</span><span class="pln"> deque</span></code></li><li class="L2"><code class="language-python"></code></li><li class="L3"><code class="language-python"></code></li><li class="L4"><code class="language-python"><span class="kwd">def</span><span class="pln"> hasPath</span><span class="pun">(</span><span class="typ">Gf</span><span class="pun">,</span><span class="pln"> s</span><span class="pun">,</span><span class="pln"> t</span><span class="pun">,</span><span class="pln"> path</span><span class="pun">):</span></code></li><li class="L5"><code class="language-python"><span class="pln">    </span><span class="com"># BFS algorithm</span></code></li><li class="L6"><code class="language-python"><span class="pln">    V </span><span class="pun">=</span><span class="pln"> len</span><span class="pun">(</span><span class="typ">Gf</span><span class="pun">)</span></code></li><li class="L7"><code class="language-python"><span class="pln">    visited </span><span class="pun">=</span><span class="pln"> list</span><span class="pun">(</span><span class="pln">range</span><span class="pun">(</span><span class="pln">V</span><span class="pun">))</span></code></li><li class="L8"><code class="language-python"><span class="pln">    </span><span class="kwd">for</span><span class="pln"> i </span><span class="kwd">in</span><span class="pln"> range</span><span class="pun">(</span><span class="pln">V</span><span class="pun">):</span></code></li><li class="L9"><code class="language-python"><span class="pln">        visited</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">False</span></code></li><li class="L0"><code class="language-python"><span class="pln">    visited</span><span class="pun">[</span><span class="pln">s</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">True</span></code></li><li class="L1"><code class="language-python"><span class="pln">    queue </span><span class="pun">=</span><span class="pln"> deque</span><span class="pun">([</span><span class="pln">s</span><span class="pun">])</span></code></li><li class="L2"><code class="language-python"><span class="pln">    </span><span class="kwd">while</span><span class="pln"> queue</span><span class="pun">:</span></code></li><li class="L3"><code class="language-python"><span class="pln">        temp </span><span class="pun">=</span><span class="pln"> queue</span><span class="pun">.</span><span class="pln">popleft</span><span class="pun">()</span></code></li><li class="L4"><code class="language-python"><span class="pln">        </span><span class="kwd">if</span><span class="pln"> temp </span><span class="pun">==</span><span class="pln"> t</span><span class="pun">:</span></code></li><li class="L5"><code class="language-python"><span class="pln">            </span><span class="kwd">return</span><span class="pln"> </span><span class="kwd">True</span></code></li><li class="L6"><code class="language-python"><span class="pln">        </span><span class="kwd">print</span><span class="pun">(</span><span class="str">"temp ="</span><span class="pun">,</span><span class="pln"> temp</span><span class="pun">)</span></code></li><li class="L7"><code class="language-python"><span class="pln">        </span><span class="kwd">for</span><span class="pln"> i </span><span class="kwd">in</span><span class="pln"> range</span><span class="pun">(</span><span class="pln">V</span><span class="pun">):</span></code></li><li class="L8"><code class="language-python"><span class="pln">            </span><span class="kwd">if</span><span class="pln"> </span><span class="kwd">not</span><span class="pln"> visited</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="kwd">and</span><span class="pln"> </span><span class="pun">(</span><span class="typ">Gf</span><span class="pun">[</span><span class="pln">temp</span><span class="pun">][</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">0</span><span class="pun">):</span></code></li><li class="L9"><code class="language-python"><span class="pln">                queue</span><span class="pun">.</span><span class="pln">append</span><span class="pun">(</span><span class="pln">i</span><span class="pun">)</span></code></li><li class="L0"><code class="language-python"><span class="pln">                visited</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">True</span></code></li><li class="L1"><code class="language-python"><span class="pln">                path</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> temp   </span><span class="com"># record precursor</span></code></li><li class="L2"><code class="language-python"><span class="pln">    </span><span class="kwd">return</span><span class="pln"> visited</span><span class="pun">[</span><span class="pln">t</span><span class="pun">]</span></code></li><li class="L3"><code class="language-python"></code></li><li class="L4"><code class="language-python"></code></li><li class="L5"><code class="language-python"><span class="kwd">def</span><span class="pln"> max_flow</span><span class="pun">(</span><span class="pln">graph</span><span class="pun">,</span><span class="pln"> s</span><span class="pun">,</span><span class="pln"> t</span><span class="pun">):</span></code></li><li class="L6"><code class="language-python"><span class="pln">    maxFlow </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span></code></li><li class="L7"><code class="language-python"><span class="pln">    </span><span class="typ">Gf</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> copy</span><span class="pun">.</span><span class="pln">deepcopy</span><span class="pun">(</span><span class="pln">graph</span><span class="pun">)</span></code></li><li class="L8"><code class="language-python"><span class="pln">    V </span><span class="pun">=</span><span class="pln"> len</span><span class="pun">(</span><span class="typ">Gf</span><span class="pun">)</span></code></li><li class="L9"><code class="language-python"><span class="pln">    path </span><span class="pun">=</span><span class="pln"> list</span><span class="pun">(</span><span class="pln">range</span><span class="pun">(</span><span class="pln">V</span><span class="pun">))</span></code></li><li class="L0"><code class="language-python"><span class="pln">    </span><span class="kwd">while</span><span class="pln"> hasPath</span><span class="pun">(</span><span class="typ">Gf</span><span class="pun">,</span><span class="pln"> s</span><span class="pun">,</span><span class="pln"> t</span><span class="pun">,</span><span class="pln"> path</span><span class="pun">):</span></code></li><li class="L1"><code class="language-python"><span class="pln">        min_flow </span><span class="pun">=</span><span class="pln"> float</span><span class="pun">(</span><span class="str">'inf'</span><span class="pun">)</span></code></li><li class="L2"><code class="language-python"></code></li><li class="L3"><code class="language-python"><span class="pln">        </span><span class="com"># find cf(p)</span></code></li><li class="L4"><code class="language-python"><span class="pln">        v </span><span class="pun">=</span><span class="pln"> t</span></code></li><li class="L5"><code class="language-python"><span class="pln">        </span><span class="kwd">while</span><span class="pln"> v </span><span class="pun">!=</span><span class="pln"> s</span><span class="pun">:</span></code></li><li class="L6"><code class="language-python"><span class="pln">            u </span><span class="pun">=</span><span class="pln"> path</span><span class="pun">[</span><span class="pln">v</span><span class="pun">]</span></code></li><li class="L7"><code class="language-python"><span class="pln">            min_flow </span><span class="pun">=</span><span class="pln"> min</span><span class="pun">(</span><span class="pln">min_flow</span><span class="pun">,</span><span class="pln"> </span><span class="typ">Gf</span><span class="pun">[</span><span class="pln">u</span><span class="pun">][</span><span class="pln">v</span><span class="pun">])</span></code></li><li class="L8"><code class="language-python"><span class="pln">            v </span><span class="pun">=</span><span class="pln"> path</span><span class="pun">[</span><span class="pln">v</span><span class="pun">]</span></code></li><li class="L9"><code class="language-python"><span class="pln">        </span><span class="kwd">print</span><span class="pun">(</span><span class="pln">min_flow</span><span class="pun">)</span></code></li><li class="L0"><code class="language-python"></code></li><li class="L1"><code class="language-python"><span class="pln">        </span><span class="com"># add flow in every edge of the augument path</span></code></li><li class="L2"><code class="language-python"><span class="pln">        v </span><span class="pun">=</span><span class="pln"> t</span></code></li><li class="L3"><code class="language-python"><span class="pln">        </span><span class="kwd">while</span><span class="pln"> v </span><span class="pun">!=</span><span class="pln"> s</span><span class="pun">:</span></code></li><li class="L4"><code class="language-python"><span class="pln">            u </span><span class="pun">=</span><span class="pln"> path</span><span class="pun">[</span><span class="pln">v</span><span class="pun">]</span></code></li><li class="L5"><code class="language-python"><span class="pln">            </span><span class="typ">Gf</span><span class="pun">[</span><span class="pln">u</span><span class="pun">][</span><span class="pln">v</span><span class="pun">]</span><span class="pln"> </span><span class="pun">-=</span><span class="pln"> min_flow</span></code></li><li class="L6"><code class="language-python"><span class="pln">            </span><span class="typ">Gf</span><span class="pun">[</span><span class="pln">v</span><span class="pun">][</span><span class="pln">u</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+=</span><span class="pln"> min_flow</span></code></li><li class="L7"><code class="language-python"><span class="pln">            v </span><span class="pun">=</span><span class="pln"> path</span><span class="pun">[</span><span class="pln">v</span><span class="pun">]</span></code></li><li class="L8"><code class="language-python"></code></li><li class="L9"><code class="language-python"><span class="pln">        maxFlow </span><span class="pun">+=</span><span class="pln"> min_flow</span></code></li><li class="L0"><code class="language-python"><span class="pln">    </span><span class="kwd">return</span><span class="pln"> maxFlow</span></code></li><li class="L1"><code class="language-python"></code></li><li class="L2"><code class="language-python"><span class="pln">M</span><span class="pun">=</span><span class="lit">0</span></code></li><li class="L3"><code class="language-python"><span class="pln">capacity </span><span class="pun">=</span><span class="pln"> </span><span class="pun">[</span></code></li><li class="L4"><code class="language-python"><span class="pun">[</span><span class="lit">0</span><span class="pun">,</span><span class="lit">16</span><span class="pun">,</span><span class="lit">13</span><span class="pun">,</span><span class="pln">M</span><span class="pun">,</span><span class="pln">M</span><span class="pun">,</span><span class="pln">M</span><span class="pun">],</span></code></li><li class="L5"><code class="language-python"><span class="pun">[</span><span class="pln">M</span><span class="pun">,</span><span class="lit">0</span><span class="pun">,</span><span class="lit">10</span><span class="pun">,</span><span class="lit">12</span><span class="pun">,</span><span class="pln">M</span><span class="pun">,</span><span class="pln">M</span><span class="pun">],</span></code></li><li class="L6"><code class="language-python"><span class="pun">[</span><span class="pln">M</span><span class="pun">,</span><span class="lit">4</span><span class="pun">,</span><span class="lit">0</span><span class="pun">,</span><span class="pln">M</span><span class="pun">,</span><span class="lit">14</span><span class="pun">,</span><span class="pln">M</span><span class="pun">],</span></code></li><li class="L7"><code class="language-python"><span class="pun">[</span><span class="pln">M</span><span class="pun">,</span><span class="pln">M</span><span class="pun">,</span><span class="lit">9</span><span class="pun">,</span><span class="lit">0</span><span class="pun">,</span><span class="pln">M</span><span class="pun">,</span><span class="lit">20</span><span class="pun">],</span></code></li><li class="L8"><code class="language-python"><span class="pun">[</span><span class="pln">M</span><span class="pun">,</span><span class="pln">M</span><span class="pun">,</span><span class="pln">M</span><span class="pun">,</span><span class="lit">7</span><span class="pun">,</span><span class="lit">0</span><span class="pun">,</span><span class="lit">4</span><span class="pun">],</span></code></li><li class="L9"><code class="language-python"><span class="pun">[</span><span class="pln">M</span><span class="pun">,</span><span class="pln">M</span><span class="pun">,</span><span class="pln">M</span><span class="pun">,</span><span class="pln">M</span><span class="pun">,</span><span class="pln">M</span><span class="pun">,</span><span class="lit">0</span><span class="pun">]</span></code></li><li class="L0"><code class="language-python"><span class="pun">]</span></code></li><li class="L1"><code class="language-python"></code></li><li class="L2"><code class="language-python"><span class="pln">flow </span><span class="pun">=</span><span class="pln"> max_flow</span><span class="pun">(</span><span class="pln">capacity</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0</span><span class="pun">,</span><span class="pln"> </span><span class="lit">5</span><span class="pun">)</span></code></li><li class="L3"><code class="language-python"><span class="kwd">print</span><span class="pun">(</span><span class="str">"flow ="</span><span class="pun">,</span><span class="pln"> flow</span><span class="pun">)</span></code></li></ol></pre></div>
</body>
</html>