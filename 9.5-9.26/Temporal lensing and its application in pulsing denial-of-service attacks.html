<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>Temporal lensing and its application in pulsing denial-of-service attacks</title>
</head>
<body>
<div style="visibility: hidden; overflow: hidden; position: absolute; top: 0px; height: 1px; width: auto; padding: 0px; border: 0px; margin: 0px; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal;"><div id="MathJax_SVG_Hidden"></div><svg><defs id="MathJax_SVG_glyphs"></defs></svg></div><div id="wmd-preview" class="wmd-preview"><div class="md-section-divider"></div><div class="md-section-divider"></div><h1 data-anchor-id="jjb6" id="temporal-lensing-and-its-application-in-pulsing-denial-of-service-attacks">Temporal lensing and its application in pulsing denial-of-service attacks</h1><p data-anchor-id="ofar"><code>security</code> <br>
Rasti R, Murthy M, Weaver N, et al. Temporal lensing and its application in pulsing denial-of-service attacks[C]//2015 IEEE Symposium on Security and Privacy. IEEE, 2015: 187-198.</p><div class="md-section-divider"></div><h2 data-anchor-id="ryun" id="2019-9-11">2019-9-11</h2><p data-anchor-id="3qgl">通过当前的DNS设施探索时间透镜创造出流量脉冲并被攻击者用于攻击。DoS攻击基本特性即为洪泛，但也分为很多小类，如：SYN,反射等。本文探索如何利用时间透镜集中洪泛时间提高攻击效率。本方法的目的为导致TCP RTO.</p><div class="md-section-divider"></div><h1 data-anchor-id="g101" id="the-attack">The Attack</h1><div class="md-section-divider"></div><h2 data-anchor-id="h84a" id="motivation-and-attack-description">Motivation and Attack Description</h2><p data-anchor-id="it52">改进传统攻击，让攻击者在两脉冲之间出发包，并使包在脉冲窗口中达到victim，如炮兵一样，多个攻击者调整自己的发包时间使包同时到达受害者。当攻击者直接发包给受害者时包的延迟是连续的，因此可以用反射器来获得不同延迟的path，该方法称为lensing。一个样例如图1. <br>
<img src="https://s2.ax1x.com/2019/09/11/nwDZOU.png" alt="nwDZOU.png"></p><div class="md-section-divider"></div><h2 data-anchor-id="tjft" id="stragegy">stragegy</h2><p data-anchor-id="bu12">攻击步骤：</p><ul data-anchor-id="eq30">
<li>通过解析器测量攻击路径延迟</li>
<li>构建发送方案</li>
<li>进行攻击</li>
</ul><div class="md-section-divider"></div><h1 data-anchor-id="b93g" id="获得延迟">获得延迟</h1><p data-anchor-id="rtvi">测量攻击者-受害者，攻击者-反射器，反射器-受害者的延迟，使用king[6]的方法。图2说明如何利用king来获得攻-受的RTT估计。King首先确定受在解析器或内，然后攻再发查询受域请求。 <br>
<img src="https://s2.ax1x.com/2019/09/13/nDXkb6.png" alt="nDXkb6.png" title=""> <br>
如果限制反射器为递归DNS解析器则更准确。如果再限制受到一个DNS，则RTT折半即为攻击路径延迟。总之，King可以帮我们测攻击路径延迟。</p><div class="md-section-divider"></div><h2 data-anchor-id="r5eb" id="open-dns-resolver">Open DNS Resolver</h2><p data-anchor-id="ldww">[16]对DNS解析器估计表明许多DNS都是暂时的，对给定IP持续数天 到 数周，因为许多解析器不迭代解析树而是将工作交给辅助解析器，这不影响本文找path延迟的任务。</p><div class="md-section-divider"></div><h2 data-anchor-id="0gxm" id="attack-path-latency-variation">Attack Path Latency Variation</h2><div class="md-section-divider"></div><h3 data-anchor-id="bal9" id="short-term-variation">Short-term variation</h3><p data-anchor-id="8si7">测量路径延迟可能会花几分钟，而这段时间路径延迟也许会变更。为研究此，本文从[1]中的3000个中抽44个样本，每2分钟测一下他们的路径延迟。图3为样例在good variation,bad variation,deceptively good variation时的延迟变化。 <br>
<img src="https://s2.ax1x.com/2019/09/13/nDjee0.png" alt="nDjee0.png" title=""> <br>
三个图分别是good，bad,deceptively good的变化情况。如果路由改变较大更改了延迟会使发到解析器的包错过脉动窗口。可以使用四分位范围来识别误导解析器，幸运的是这些只是少数，如图4. <br>
<img src="https://s2.ax1x.com/2019/09/13/nDj5lj.png" alt="nDj5lj.png" title=""> <br>
根据测试，有的解析器需要攻击前进行延迟测量，不good的只是少数，因此攻击者在短的时期内将所有的解析器视为good是完全可以的.</p><div class="md-section-divider"></div><h3 data-anchor-id="tlui" id="long-term-variation-and-caching">Long-term variation and caching</h3><p data-anchor-id="qzhn">本部分专注于测量有效时间为数日到数周的情况。 <br>
测量前使用前面的解析器样本并每4小时发50个包进行10天的实验，每个解析器使用测量集的中位数作一次测量结果，最后计算标准差并用均值均值除以标准差作系数，结时展示于图5. <br>
<img src="https://s2.ax1x.com/2019/09/13/nDv34S.png" alt="nDv34S.png" title=""> <br>
可见一些解析器的方差随时间变化很小，这些测量结果的机器可被缓冲，当标准差系数低于0.002时便认为其有一个一致路径延迟，其可被缓存并可用于攻击加速。同时发现高延迟路径的方差系数都很大。</p><div class="md-section-divider"></div><h2 data-anchor-id="r2b2" id="amplification-attacks">Amplification Attacks</h2><p data-anchor-id="f73z">可以利用DNS和len结合作放大攻击，因为其易被利用。</p><div class="md-section-divider"></div><h1 data-anchor-id="lurf" id="构建最优规划">构建最优规划</h1><p data-anchor-id="asqf">制定规划将攻击者发送窗口分为多个时间槽，每个槽应发给哪个解析器。 <br>
对反射器R，时间槽T，定义脉冲窗口window表时脉冲持续时间，目的是最大化window的发送包数，使用贪心算法获得规划（给定t，R，延迟时间），最终获得的结果确实是最优的。对于由攻击产生的阻塞本文认为不会反过来抑制攻击。</p><div class="md-section-divider"></div><h1 data-anchor-id="oz0h" id="攻击实验">攻击实验</h1><p data-anchor-id="zj33">模拟攻击使用WestCoast作攻，使用Azure VM，AWS作为受害者，使用[1]中的DNS。注册一个域名并让AWS授权域名，Azure授子域名。攻击者先扫描解析器列表，并为每个解析器构建延迟查询直方图，再用算法制定攻击规划，依规划攻击。</p><div class="md-section-divider"></div><h2 data-anchor-id="gdjj" id="特征测量">特征测量</h2><div class="md-section-divider"></div><h3 data-anchor-id="x3z3" id="dimension">dimension</h3><ul data-anchor-id="a930">
<li>攻击者带宽：通过抑制发送率，模拟攻击都所拥有的不同带宽。</li>
<li>每个反射器的最大带宽：避免发太多给反射器。</li>
<li>脉冲窗口尺寸 <br>
由于资源多少并不清楚，所以一开始就限制最大攻击带宽。</li>
</ul><div class="md-section-divider"></div><h3 data-anchor-id="1d75" id="metrics">Metrics</h3><p data-anchor-id="ha9n">不能以窗口内包数作为指标（结果受窗口大小影响）。测量指标：</p><ul data-anchor-id="v9il">
<li>bandwidth gain:<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-1-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -1063.3248744694856 5231.162449071885 1626.6497489389712" style="width: 12.111ex; height: 3.778ex; vertical-align: -1.444ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g transform="translate(120,0)"><rect stroke="none" width="4991" height="60" x="0" y="220"></rect><g transform="translate(60,535)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(33.827517007443646) matrix(1 0 0 -1 0 0)">受</text><g transform="translate(541,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(33.827517007443646) matrix(1 0 0 -1 0 0)">害</text></g><g transform="translate(1082,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(33.827517007443646) matrix(1 0 0 -1 0 0)">者</text></g><g transform="translate(1623,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(33.827517007443646) matrix(1 0 0 -1 0 0)">脉</text></g><g transform="translate(2164,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(33.827517007443646) matrix(1 0 0 -1 0 0)">冲</text></g><g transform="translate(2706,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(33.827517007443646) matrix(1 0 0 -1 0 0)">窗</text></g><g transform="translate(3247,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(33.827517007443646) matrix(1 0 0 -1 0 0)">口</text></g><g transform="translate(3788,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(33.827517007443646) matrix(1 0 0 -1 0 0)">带</text></g><g transform="translate(4329,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(33.827517007443646) matrix(1 0 0 -1 0 0)">宽</text></g></g><g transform="translate(60,-408)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(33.827517007443646) matrix(1 0 0 -1 0 0)">攻</text><g transform="translate(541,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(33.827517007443646) matrix(1 0 0 -1 0 0)">击</text></g><g transform="translate(1082,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(33.827517007443646) matrix(1 0 0 -1 0 0)">者</text></g><g transform="translate(1623,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(33.827517007443646) matrix(1 0 0 -1 0 0)">最</text></g><g transform="translate(2164,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(33.827517007443646) matrix(1 0 0 -1 0 0)">大</text></g><g transform="translate(2706,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(33.827517007443646) matrix(1 0 0 -1 0 0)">发</text></g><g transform="translate(3247,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(33.827517007443646) matrix(1 0 0 -1 0 0)">送</text></g><g transform="translate(3788,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(33.827517007443646) matrix(1 0 0 -1 0 0)">带</text></g><g transform="translate(4329,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(33.827517007443646) matrix(1 0 0 -1 0 0)">宽</text></g></g></g></g></svg></span><script type="math/tex" id="MathJax-Element-1">\frac{受害者脉冲窗口带宽}{攻击者最大发送带宽}</script></li>
<li>concentration efficiency:<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-2-Frame" role="textbox" aria-readonly="true" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -1063.3248744694856 4148.681904833688 1626.6497489389712" style="width: 9.667ex; height: 3.778ex; vertical-align: -1.444ex; margin: 1px 0px;"><g stroke="black" fill="black" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g transform="translate(120,0)"><rect stroke="none" width="3908" height="60" x="0" y="220"></rect><g transform="translate(60,535)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(33.827517007443646) matrix(1 0 0 -1 0 0)">进</text><g transform="translate(541,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(33.827517007443646) matrix(1 0 0 -1 0 0)">入</text></g><g transform="translate(1082,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(33.827517007443646) matrix(1 0 0 -1 0 0)">窗</text></g><g transform="translate(1623,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(33.827517007443646) matrix(1 0 0 -1 0 0)">口</text></g><g transform="translate(2164,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(33.827517007443646) matrix(1 0 0 -1 0 0)">的</text></g><g transform="translate(2706,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(33.827517007443646) matrix(1 0 0 -1 0 0)">包</text></g><g transform="translate(3247,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(33.827517007443646) matrix(1 0 0 -1 0 0)">数</text></g></g><g transform="translate(601,-408)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(33.827517007443646) matrix(1 0 0 -1 0 0)">总</text><g transform="translate(541,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(33.827517007443646) matrix(1 0 0 -1 0 0)">发</text></g><g transform="translate(1082,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(33.827517007443646) matrix(1 0 0 -1 0 0)">送</text></g><g transform="translate(1623,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(33.827517007443646) matrix(1 0 0 -1 0 0)">包</text></g><g transform="translate(2164,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-style="" font-weight="" stroke="none" transform="scale(33.827517007443646) matrix(1 0 0 -1 0 0)">数</text></g></g></g></g></svg></span><script type="math/tex" id="MathJax-Element-2">\frac{进入窗口的包数}{总发送包数}</script> <br>
两个指标需要共同使用，因为<strong>大窗口</strong>有<strong>高集中率</strong>但<strong>低带宽收益</strong>，<strong>小窗口</strong>但<strong>低集中率</strong>有<strong>高带宽收益</strong></li>
</ul><div class="md-section-divider"></div><h1 data-anchor-id="k2tv" id="results">Results</h1><p data-anchor-id="2nq2">图7为模拟脉冲攻击结果，低，中，高带宽实例中带宽收益分别为：14,10,5,集中率的低中带宽实例为：50%,高带宽实例为40%。7a中不同颜色包代表不同反射器，可见有的贡献脉冲有的没有。7b,7c为多路脉冲，由于解析器发给受害者太多导致解析器有的要重传，重传又会产生新的脉冲。 <br>
<img src="https://s2.ax1x.com/2019/09/13/nrVJoQ.png" alt="nrVJoQ.png" title=""> <br>
图8展示指标随窗口大小改变而变化的情况 <br>
<img src="https://s2.ax1x.com/2019/09/13/nrR7ff.png" alt="nrR7ff.png" title=""> <br>
图9展示带宽收益和集中率随最大带宽变化情况，可见过度抑制带宽无法产生脉冲，少量抑制对攻击率基本无影响。 <br>
<img src="https://s2.ax1x.com/2019/09/13/nrWkX4.png" alt="nrWkX4.png" title=""> <br>
图10为指标随攻击带宽变化，基本都是well。但当攻击带宽太大会出现集中率降低的情况，经过多次实现总结应该是攻击太强使带宽饱和，并在AWS中结果（见图11）证实了该结论。 <br>
<img src="https://s2.ax1x.com/2019/09/13/nrWQ1O.png" alt="nrWQ1O.png" title=""> <br>
Azure中的脉冲分布见图12.它与AWS不同，图12,14量化了这个不同。Azure中分布连续，但当AWS作为受害者时，攻击者高带宽时它会收到更少的包，表明AWS的router在处理过量包时会进行丢弃而非查询，这表明我方的攻击有效。 <br>
<img src="https://s2.ax1x.com/2019/09/13/nrW0gS.png" alt="nrW0gS.png" title=""> <br>
<img src="https://s2.ax1x.com/2019/09/13/nrWruQ.png" alt="nrWruQ.png" title=""></p><div class="md-section-divider"></div><h1 data-anchor-id="6333" id="extending-the-attack">Extending the Attack</h1><div class="md-section-divider"></div><h2 data-anchor-id="2gnf" id="attacks-on-arbitrary-end-hosts">Attacks on ARbitrary End-hosts</h2><p data-anchor-id="226s">首先计算DNS解析器与其他类弄DNS顺之间的延迟，如图15,在自己的DNS服务A中声明：B对D授权，再从A查D会得到失败消息，但能获得RTT。接下来将B换成任终端主机根据RFC1122我方可以得到大多数主机的RTT。最后找与受害者共定位的DNS即可。 <br>
<img src="https://s2.ax1x.com/2019/09/13/nrWhgU.png" alt="nrWhgU.png" title=""></p><ul data-anchor-id="vsao">
<li>在攻击中可加入放大攻击原理以加强攻击效果。</li>
<li>多个不同地理位置的攻击协作攻击以加强效果。</li>
<li>提高带宽收益：1.增加攻击路径延迟以增加攻击带宽利用率。2.利用传，把握好重传使其可以增强其他脉冲。</li>
</ul><div class="md-section-divider"></div><h1 data-anchor-id="3au1" id="防御">防御</h1><ul data-anchor-id="cwx7">
<li>通过对返回信息增加延迟以阻止侦察。攻击者只需测试不受victim控制的解析器械即可。</li>
<li>通过让router增加延迟抖动来防御，结果可见图16.然而攻击者可以隐藏侦察。 <br>
<img src="https://s2.ax1x.com/2019/09/13/nrWzKe.png" alt="nrWzKe.png" title=""></li>
</ul></div>
</body>
</html>